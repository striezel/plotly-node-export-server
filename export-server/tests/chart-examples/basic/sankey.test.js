const assert = require('node:assert');
const http = require('node:http');
const { describe, it } = require('node:test');

describe('basic charts, part 10', () => {
  describe('sankey diagrams', () => {
    it('Basic Sankey Diagram', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/sankey-diagram/#basic-sankey-diagram example.
      const payload = `{
                         "data": [
                           {
                             "type": "sankey",
                             "orientation": "h",
                             "node": {
                               "pad": 15,
                               "thickness": 30,
                               "line": {
                                 "color": "black",
                                 "width": 0.5
                               },
                               "label": [ "A1", "A2", "B1", "B2", "C1", "C2" ],
                               "color": [ "blue", "blue", "blue", "blue", "blue", "blue" ]
                             },
                             "link": {
                               "source": [ 0, 1, 0, 2, 3, 3 ],
                               "target": [ 2, 3, 3, 4, 4, 5 ],
                               "value": [ 8, 4, 2, 8, 4, 2 ]
                             }
                           }
                         ],
                         "layout": {
                           "title": {
                             "text": "Basic Sankey"
                           },
                           "font": {
                             "size": 10
                           }
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based answer would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-36383f"><g class="clips"/><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"/><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><g class="sankey" style="box-sizing: content-box; position: absolute; left: 0px; shape-rendering: geometricprecision; pointer-events: none;" transform="translate(80,100)matrix(1 0 0 1 0 0)"><g class="sankey-links" style="fill: none;"><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0px; opacity: 1;" d="M30,1.2789769243681803e-13C142.5,1.2789769243681803e-13 142.5,4.689582056016661e-13 255,4.689582056016661e-13L255,145.71428571428618C142.5,145.71428571428618 142.5,145.71428571428584 30,145.71428571428584Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0px; opacity: 1;" d="M30,197.14285714285717C142.5,197.14285714285717 142.5,197.14285714285757 255,197.14285714285757L255,270.00000000000045C142.5,270.00000000000045 142.5,270.00000000000006 30,270.00000000000006Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0px; opacity: 1;" d="M30,145.71428571428586C142.5,145.71428571428586 142.5,160.71428571428612 255,160.71428571428612L255,197.14285714285757C142.5,197.14285714285757 142.5,182.1428571428573 30,182.1428571428573Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0px; opacity: 1;" d="M285,4.689582056016661e-13C397.5,4.689582056016661e-13 397.5,-1.4210854715202004e-14 510,-1.4210854715202004e-14L510,145.71428571428572C397.5,145.71428571428572 397.5,145.71428571428618 285,145.71428571428618Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0px; opacity: 1;" d="M285,160.71428571428612C397.5,160.71428571428612 397.5,145.71428571428567 510,145.71428571428567L510,218.57142857142856C397.5,218.57142857142856 397.5,233.571428571429 285,233.571428571429Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0px; opacity: 1;" d="M285,233.57142857142898C397.5,233.57142857142898 397.5,233.57142857142858 510,233.57142857142858L510,270C397.5,270 397.5,270.0000000000004 285,270.0000000000004Z"/></g><g class="sankey-node-set" style="cursor: move;"><g class="sankey-node" transform="translate(0.000,0.000)" style="opacity: 1;"><rect class="node-rect" width="30" height="182.14285714285705" style="stroke-width: 0.5px; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: rgb(255, 255, 255) 1px 1px 1px, rgb(255, 255, 255) -1px -1px 1px, rgb(255, 255, 255) 1px -1px 1px, rgb(255, 255, 255) -1px 1px 1px; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,94.57142857142853)">A1</text></g><g class="sankey-node" transform="translate(0.000,197.143)" style="opacity: 1;"><rect class="node-rect" width="30" height="72.8571428571428" style="stroke-width: 0.5px; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: rgb(255, 255, 255) 1px 1px 1px, rgb(255, 255, 255) -1px -1px 1px, rgb(255, 255, 255) 1px -1px 1px, rgb(255, 255, 255) -1px 1px 1px; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,39.9285714285714)">A2</text></g><g class="sankey-node" transform="translate(255.000,0.000)" style="opacity: 1;"><rect class="node-rect" width="30" height="145.71428571428567" style="stroke-width: 0.5px; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: rgb(255, 255, 255) 1px 1px 1px, rgb(255, 255, 255) -1px -1px 1px, rgb(255, 255, 255) 1px -1px 1px, rgb(255, 255, 255) -1px 1px 1px; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,76.35714285714283)">B1</text></g><g class="sankey-node" transform="translate(255.000,160.714)" style="opacity: 1;"><rect class="node-rect" width="30" height="109.28571428571388" style="stroke-width: 0.5px; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: rgb(255, 255, 255) 1px 1px 1px, rgb(255, 255, 255) -1px -1px 1px, rgb(255, 255, 255) 1px -1px 1px, rgb(255, 255, 255) -1px 1px 1px; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,58.14285714285694)">B2</text></g><g class="sankey-node" transform="translate(510.000,-0.000)" style="opacity: 1;"><rect class="node-rect" width="30" height="218.5714285714286" style="stroke-width: 0.5px; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: rgb(255, 255, 255) 1px 1px 1px, rgb(255, 255, 255) -1px -1px 1px, rgb(255, 255, 255) 1px -1px 1px, rgb(255, 255, 255) -1px 1px 1px; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="end" transform="translate(-3.25,112.7857142857143)">C1</text></g><g class="sankey-node" transform="translate(510.000,233.571)" style="opacity: 1;"><rect class="node-rect" width="30" height="36.428571428571416" style="stroke-width: 0.5px; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: rgb(255, 255, 255) 1px 1px 1px, rgb(255, 255, 255) -1px -1px 1px, rgb(255, 255, 255) 1px -1px 1px, rgb(255, 255, 255) -1px 1px 1px; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="end" transform="translate(-3.25,21.714285714285708)">C2</text></g></g></g><defs id="topdefs-36383f"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Basic Sankey</text></g><g class="first-render"/></g></svg>

          // Current server response is visually the same.
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-911250"><g class="clips"/><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"/><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><g class="sankey" style="box-sizing: content-box; position: absolute; left: 0px; shape-rendering: geometricPrecision; pointer-events: none;" transform="translate(80,100)matrix(1 0 0 1 0 0)"><g class="sankey-links" style="fill: none;"><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M30,1.2789769243681803e-13C142.5,1.2789769243681803e-13 142.5,4.689582056016661e-13 255,4.689582056016661e-13L255,145.71428571428618C142.5,145.71428571428618 142.5,145.71428571428584 30,145.71428571428584Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M30,197.14285714285717C142.5,197.14285714285717 142.5,197.14285714285757 255,197.14285714285757L255,270.00000000000045C142.5,270.00000000000045 142.5,270.00000000000006 30,270.00000000000006Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M30,145.71428571428586C142.5,145.71428571428586 142.5,160.71428571428612 255,160.71428571428612L255,197.14285714285757C142.5,197.14285714285757 142.5,182.1428571428573 30,182.1428571428573Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M285,4.689582056016661e-13C397.5,4.689582056016661e-13 397.5,-1.4210854715202004e-14 510,-1.4210854715202004e-14L510,145.71428571428572C397.5,145.71428571428572 397.5,145.71428571428618 285,145.71428571428618Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M285,160.71428571428612C397.5,160.71428571428612 397.5,145.71428571428567 510,145.71428571428567L510,218.57142857142856C397.5,218.57142857142856 397.5,233.571428571429 285,233.571428571429Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M285,233.57142857142898C397.5,233.57142857142898 397.5,233.57142857142858 510,233.57142857142858L510,270C397.5,270 397.5,270.0000000000004 285,270.0000000000004Z"/></g><g class="sankey-node-set" style="cursor: move;"><g class="sankey-node" transform="translate(0.000,0.000)" style="opacity: 1;"><rect class="node-rect" width="30" height="182.14285714285705" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,94.57142857142853)">A1</text></g><g class="sankey-node" transform="translate(0.000,197.143)" style="opacity: 1;"><rect class="node-rect" width="30" height="72.8571428571428" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,39.9285714285714)">A2</text></g><g class="sankey-node" transform="translate(255.000,0.000)" style="opacity: 1;"><rect class="node-rect" width="30" height="145.71428571428567" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,76.35714285714283)">B1</text></g><g class="sankey-node" transform="translate(255.000,160.714)" style="opacity: 1;"><rect class="node-rect" width="30" height="109.28571428571388" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,58.14285714285694)">B2</text></g><g class="sankey-node" transform="translate(510.000,-0.000)" style="opacity: 1;"><rect class="node-rect" width="30" height="218.5714285714286" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="end" transform="translate(-3.25,112.7857142857143)">C1</text></g><g class="sankey-node" transform="translate(510.000,233.571)" style="opacity: 1;"><rect class="node-rect" width="30" height="36.428571428571416" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="end" transform="translate(-3.25,21.714285714285708)">C2</text></g></g></g><defs id="topdefs-911250"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Basic Sankey</text></g><g class="first-render"/></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs') >= 0);
          assert.ok(body.indexOf('<g class="clips"/><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"/><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><g class="sankey" style="box-sizing: content-box; position: absolute; left: 0px; shape-rendering: geometricPrecision; pointer-events: none;" transform="translate(80,100)matrix(1 0 0 1 0 0)"><g class="sankey-links" style="fill: none;"><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M30,1.2789769243681803e-13C142.5,1.2789769243681803e-13 142.5,4.689582056016661e-13 255,4.689582056016661e-13L255,145.71428571428618C142.5,145.71428571428618 142.5,145.71428571428584 30,145.71428571428584Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M30,197.14285714285717C142.5,197.14285714285717 142.5,197.14285714285757 255,197.14285714285757L255,270.00000000000045C142.5,270.00000000000045 142.5,270.00000000000006 30,270.00000000000006Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M30,145.71428571428586C142.5,145.71428571428586 142.5,160.71428571428612 255,160.71428571428612L255,197.14285714285757C142.5,197.14285714285757 142.5,182.1428571428573 30,182.1428571428573Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M285,4.689582056016661e-13C397.5,4.689582056016661e-13 397.5,-1.4210854715202004e-14 510,-1.4210854715202004e-14L510,145.71428571428572C397.5,145.71428571428572 397.5,145.71428571428618 285,145.71428571428618Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M285,160.71428571428612C397.5,160.71428571428612 397.5,145.71428571428567 510,145.71428571428567L510,218.57142857142856C397.5,218.57142857142856 397.5,233.571428571429 285,233.571428571429Z"/><path class="sankey-link" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(0, 0, 0); fill-opacity: 0.2; stroke-width: 0; opacity: 1;" d="M285,233.57142857142898C397.5,233.57142857142898 397.5,233.57142857142858 510,233.57142857142858L510,270C397.5,270 397.5,270.0000000000004 285,270.0000000000004Z"/></g><g class="sankey-node-set" style="cursor: move;"><g class="sankey-node" transform="translate(0.000,0.000)" style="opacity: 1;"><rect class="node-rect" width="30" height="182.14285714285705" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,94.57142857142853)">A1</text></g>') > 0);
          assert.ok(body.indexOf('<g class="sankey-node" transform="translate(0.000,197.143)" style="opacity: 1;"><rect class="node-rect" width="30" height="72.8571428571428" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,39.9285714285714)">A2</text></g><g class="sankey-node" transform="translate(255.000,0.000)" style="opacity: 1;"><rect class="node-rect" width="30" height="145.71428571428567" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,76.35714285714283)">B1</text></g><g class="sankey-node" transform="translate(255.000,160.714)" style="opacity: 1;"><rect class="node-rect" width="30" height="109.28571428571388" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="start" transform="translate(33.25,58.14285714285694)">B2</text></g><g class="sankey-node" transform="translate(510.000,-0.000)" style="opacity: 1;"><rect class="node-rect" width="30" height="218.5714285714286" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="end" transform="translate(-3.25,112.7857142857143)">C1</text></g><g class="sankey-node" transform="translate(510.000,233.571)" style="opacity: 1;"><rect class="node-rect" width="30" height="36.428571428571416" style="stroke-width: 0.5; stroke: rgb(0, 0, 0); stroke-opacity: 1; fill: rgb(0, 0, 255); fill-opacity: 1;"/><text class="node-label" style="cursor: default; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 10px; fill: rgb(68, 68, 68); fill-opacity: 1; text-shadow: 1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff; white-space: pre;" data-notex="1" x="0" y="0" text-anchor="end" transform="translate(-3.25,21.714285714285708)">C2</text></g></g></g><defs id="topdefs') > 0);
          assert.ok(body.indexOf('<g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Basic Sankey</text></g><g class="first-render"/></g></svg>') > 0);
        });
      });
    });
  });
});
