/*
    Plotly.js offline image export server with Node.js test suite
    Copyright (C) 2024  Dirk Stolle

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

const assert = require('node:assert');
const http = require('node:http');
const { describe, it } = require('node:test');

describe('basic charts, part 3', () => {
  describe('bar charts', () => {
    it('Basic Bar Chart', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#basic-bar-chart example.
      const payload = `[
                         {
                           "x": [ "giraffes", "orangutans", "monkeys" ],
                           "y": [ 20, 14, 23 ],
                           "type": "bar"
                         }
                       ]`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based answer would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="400" style="" viewBox="0 0 700 400"><rect x="0" y="0" width="700" height="400" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-d8139d"><g class="clips"><clipPath id="clipd8139dxyplot" class="plotclip"><rect width="540" height="220"/></clipPath><clipPath class="axesclip" id="clipd8139dx"><rect x="80" y="0" width="540" height="400"/></clipPath><clipPath class="axesclip" id="clipd8139dy"><rect x="0" y="100" width="700" height="220"/></clipPath><clipPath class="axesclip" id="clipd8139dxy"><rect x="80" y="100" width="540" height="220"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,274.57)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,229.13)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,183.7)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,138.26)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,320)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipd8139dxyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M18,220V38.26H162V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M198,220V92.78H342V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M378,220V11H522V220Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">giraffes</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">orangutans</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">monkeys</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,320)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,274.57)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,229.13)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,183.7)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,138.26)">20</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-d8139d"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Current server response is the same, except for random ids.

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="400" style="" viewBox="0 0 700 400"><rect x="0" y="0" width="700" height="400" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs') >= 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="220"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="80" y="0" width="540" height="400"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="0" y="100" width="700" height="220"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="80" y="100" width="540" height="220"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,274.57)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,229.13)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,183.7)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,138.26)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,320)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('<g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M18,220V38.26H162V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M198,220V92.78H342V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M378,220V11H522V220Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">giraffes</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">orangutans</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">monkeys</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,320)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,274.57)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,229.13)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,183.7)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,138.26)">20</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs') > 0);
          assert.ok(body.indexOf('<g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>') > 0);
        });
      });
    });

    it('Grouped Bar Chart', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#grouped-bar-chart example.
      const payload = `{
                         "data": [
                           {
                             "x": [ "giraffes", "orangutans", "monkeys" ],
                             "y": [ 20, 14, 23 ],
                             "name": "SF Zoo",
                             "type": "bar"
                           },
                           {
                             "x": [ "giraffes", "orangutans", "monkeys" ],
                             "y": [ 12, 18, 29 ],
                             "name": "LA Zoo",
                             "type": "bar"
                           }
                         ],
                         "layout": {
                           "barmode": "group"
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based output would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-c729a8"><g class="clips"><clipPath id="clipc729a8xyplot" class="plotclip"><rect width="511" height="270"/></clipPath><clipPath class="axesclip" id="clipc729a8x"><rect x="80" y="0" width="511" height="450"/></clipPath><clipPath class="axesclip" id="clipc729a8y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clipc729a8xy"><rect x="80" y="100" width="511" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,325.78)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,281.55)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,237.33)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,193.1)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,148.88)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,104.66)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h511" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipc729a8xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M17.03,270V93.1H85.17V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M187.37,270V146.17H255.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M357.7,270V66.57H425.83V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M85.17,270V163.86H153.3V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M255.5,270V110.79H323.63V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M425.83,270V13.5H493.97V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(165.17000000000002,0)">giraffes</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(335.5,0)">orangutans</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(505.83,0)">monkeys</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,325.78)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,281.55)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,237.33)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,193.1)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,148.88)">25</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,104.66)">30</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-c729a8"><g class="clips"/><clipPath id="legendc729a8"><rect width="87" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(601.22,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="87" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legendc729a8)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">SF Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="81.33332824707031" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">LA Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="81.33332824707031" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Current server response is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-5d7797"><g class="clips"><clipPath id="clip5d7797xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip5d7797x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip5d7797y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip5d7797xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,325.78)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,281.55)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,237.33)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,193.1)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,148.88)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,104.66)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip5d7797xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M18,270V93.1H90V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M198,270V146.17H270V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M378,270V66.57H450V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M90,270V163.86H162V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M270,270V110.79H342V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M450,270V13.5H522V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">giraffes</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">orangutans</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">monkeys</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,325.78)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,281.55)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,237.33)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,193.1)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,148.88)">25</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,104.66)">30</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-5d7797"><g class="clips"/><clipPath id="legend5d7797"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend5d7797)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">SF Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">LA Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,325.78)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,281.55)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,237.33)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,193.1)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,148.88)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,104.66)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M18,270V93.1H90V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M198,270V146.17H270V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M378,270V66.57H450V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M90,270V163.86H162V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M270,270V110.79H342V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M450,270V13.5H522V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">giraffes</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">orangutans</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">monkeys</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,325.78)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,281.55)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,237.33)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,193.1)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,148.88)">25</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,104.66)">30</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/><clipPath id="legend') > 0);
          assert.ok(body.indexOf('"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend') > 0);
          assert.ok(body.indexOf(')"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">SF Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">LA Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>') > 0);
        });
      });
    });

    it('Stacked Bar Chart', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#stacked-bar-chart example.
      const payload = `{
                         "data": [
                           {
                             "x": [ "giraffes", "orangutans", "monkeys" ],
                             "y": [ 20, 14, 23 ],
                             "name": "SF Zoo",
                             "type": "bar"
                           },
                           {
                             "x": [ "giraffes", "orangutans", "monkeys" ],
                             "y": [ 12, 18, 29 ],
                             "name": "LA Zoo",
                             "type": "bar"
                           }
                         ],
                         "layout": {
                           "barmode": "stack"
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based output would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-8fdb68"><g class="clips"><clipPath id="clip8fdb68xyplot" class="plotclip"><rect width="511" height="270"/></clipPath><clipPath class="axesclip" id="clip8fdb68x"><rect x="80" y="0" width="511" height="450"/></clipPath><clipPath class="axesclip" id="clip8fdb68y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip8fdb68xy"><rect x="80" y="100" width="511" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,320.66999999999996)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,271.35)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,222.01999999999998)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,172.69)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,123.37)" d="M80,0h511" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h511" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip8fdb68xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M17.03,270V171.35H153.3V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M187.37,270V200.94H323.63V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M357.7,270V156.55H493.97V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M17.03,171.35V112.15H153.3V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M187.37,200.94V112.15H323.63V200.94Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M357.7,156.55V13.5H493.97V156.55Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(165.17000000000002,0)">giraffes</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(335.5,0)">orangutans</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(505.83,0)">monkeys</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,320.66999999999996)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,271.35)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,222.01999999999998)">30</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,172.69)">40</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,123.37)">50</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-8fdb68"><g class="clips"/><clipPath id="legend8fdb68"><rect width="87" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(601.22,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="87" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend8fdb68)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">LA Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="81.33332824707031" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">SF Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="81.33332824707031" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Current server response is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-b0866c"><g class="clips"><clipPath id="clipb0866cxyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clipb0866cx"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clipb0866cy"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clipb0866cxy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,320.66999999999996)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,271.35)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,222.01999999999998)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,172.69)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,123.37)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipb0866cxyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M18,270V171.35H162V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M198,270V200.94H342V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M378,270V156.55H522V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M18,171.35V112.15H162V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M198,200.94V112.15H342V200.94Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M378,156.55V13.5H522V156.55Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">giraffes</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">orangutans</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">monkeys</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,320.66999999999996)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,271.35)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,222.01999999999998)">30</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,172.69)">40</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,123.37)">50</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-b0866c"><g class="clips"/><clipPath id="legendb0866c"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legendb0866c)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">LA Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">SF Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,320.66999999999996)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,271.35)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,222.01999999999998)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,172.69)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,123.37)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M18,270V171.35H162V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M198,270V200.94H342V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M378,270V156.55H522V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M18,171.35V112.15H162V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M198,200.94V112.15H342V200.94Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M378,156.55V13.5H522V156.55Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">giraffes</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">orangutans</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">monkeys</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,320.66999999999996)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,271.35)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,222.01999999999998)">30</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,172.69)">40</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,123.37)">50</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/><clipPath id="legend') > 0);
          assert.ok(body.indexOf('"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend') > 0);
          assert.ok(body.indexOf(')"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">LA Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">SF Zoo</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>') > 0);
        });
      });
    });

    it('Bar Chart with Hover Text', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#bar-chart-with-hover-text example.
      const payload = `{
                         "data": [
                           {
                             "x": [ "Liam", "Sophie", "Jacob", "Mia", "William", "Olivia" ],
                             "y": [ 8, 8, 12, 12, 13, 20 ],
                             "type": "bar",
                             "text": [
                               "4.17 below the mean",
                               "4.17 below the mean",
                               "0.17 below the mean",
                               "0.17 below the mean",
                               "0.83 above the mean",
                               "7.83 above the mean"
                             ],
                             "marker": {
                               "color": "rgb(142,124,195)"
                             }
                           }
                         ],
                         "layout": {
                           "title": {
                             "text": "Number of Graphs Made this Week"
                           },
                           "font": {
                             "family": "Raleway, sans-serif"
                           },
                           "showlegend": false,
                           "xaxis": {
                             "tickangle": -45
                           },
                           "yaxis": {
                             "zeroline": false,
                             "gridwidth": 2
                           },
                           "bargap": 0.05
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based answer would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="400" style="" viewBox="0 0 700 400"><rect x="0" y="0" width="700" height="400" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-625e39"><g class="clips"><clipPath id="clip625e39xyplot" class="plotclip"><rect width="540" height="220"/></clipPath><clipPath class="axesclip" id="clip625e39x"><rect x="80" y="0" width="540" height="400"/></clipPath><clipPath class="axesclip" id="clip625e39y"><rect x="0" y="100" width="700" height="220"/></clipPath><clipPath class="axesclip" id="clip625e39xy"><rect x="80" y="100" width="540" height="220"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,267.75)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/><path class="ygrid crisp" transform="translate(0,215.5)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/><path class="ygrid crisp" transform="translate(0,163.25)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/><path class="ygrid crisp" transform="translate(0,111)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/></g></g><g class="zerolinelayer"/><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip625e39xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M2.25,220V136.4H87.75V220Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(45.00012186985502,147.3868628187631)scale(0.6143740629817751)">4.17 below the mean</text></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M92.25,220V136.4H177.75V220Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(135.00012186985504,147.3868628187631)scale(0.6143740629817751)">4.17 below the mean</text></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M182.25,220V94.6H267.75V220Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(225.00018303472567,161.45224130868058)scale(0.9227202908179113)rotate(90 -0.0001983642578125 -4.5)">0.17 below the mean</text></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M272.25,220V94.6H357.75V220Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(315.00018303472564,161.45224130868058)scale(0.9227202908179113)rotate(90 -0.0001983642578125 -4.5)">0.17 below the mean</text></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M362.25,220V84.15H447.75V220Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(404.99960585162245,156.5457340889488)scale(0.9934964642108463)rotate(90 0.000396728515625 -4.5)">0.83 above the mean</text></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M452.25,220V11H537.75V220Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(494.9996032714844,83.85000610351562)rotate(90 0.000396728515625 -4.5)">7.83 above the mean</text></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="end" x="0" y="333" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(125,0) rotate(-45,0,327)">Liam</text></g><g class="xtick"><text text-anchor="end" x="0" y="333" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(215,0) rotate(-45,0,327)">Sophie</text></g><g class="xtick"><text text-anchor="end" x="0" y="333" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(305,0) rotate(-45,0,327)">Jacob</text></g><g class="xtick"><text text-anchor="end" x="0" y="333" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(395,0) rotate(-45,0,327)">Mia</text></g><g class="xtick"><text text-anchor="end" x="0" y="333" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(485,0) rotate(-45,0,327)">William</text></g><g class="xtick"><text text-anchor="end" x="0" y="333" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(575,0) rotate(-45,0,327)">Olivia</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,320)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,267.75)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,215.5)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,163.25)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,111)">20</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-625e39"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: Raleway, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Number of Graphs Made this Week</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Current server response is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-b2e016"><g class="clips"><clipPath id="clipb2e016xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clipb2e016x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clipb2e016y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clipb2e016xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,305.88)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/><path class="ygrid crisp" transform="translate(0,241.75)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/><path class="ygrid crisp" transform="translate(0,177.63)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/><path class="ygrid crisp" transform="translate(0,113.5)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/></g></g><g class="zerolinelayer"/><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipb2e016xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M2.25,270V167.4H87.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M92.25,270V167.4H177.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M182.25,270V116.1H267.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M272.25,270V116.1H357.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M362.25,270V103.28H447.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M452.25,270V13.5H537.75V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(125,0) rotate(-45,0,377)">Liam</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(215,0) rotate(-45,0,377)">Sophie</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(305,0) rotate(-45,0,377)">Jacob</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(395,0) rotate(-45,0,377)">Mia</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(485,0) rotate(-45,0,377)">William</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(575,0) rotate(-45,0,377)">Olivia</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,305.88)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,241.75)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,177.63)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,113.5)">20</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-b2e016"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: Raleway, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Number of Graphs Made this Week</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,305.88)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/><path class="ygrid crisp" transform="translate(0,241.75)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/><path class="ygrid crisp" transform="translate(0,177.63)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/><path class="ygrid crisp" transform="translate(0,113.5)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 2px;"/></g></g><g class="zerolinelayer"/><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M2.25,270V167.4H87.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M92.25,270V167.4H177.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M182.25,270V116.1H267.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M272.25,270V116.1H357.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M362.25,270V103.28H447.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(142, 124, 195); fill-opacity: 1;" d="M452.25,270V13.5H537.75V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(125,0) rotate(-45,0,377)">Liam</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(215,0) rotate(-45,0,377)">Sophie</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(305,0) rotate(-45,0,377)">Jacob</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(395,0) rotate(-45,0,377)">Mia</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(485,0) rotate(-45,0,377)">William</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(575,0) rotate(-45,0,377)">Olivia</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,305.88)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,241.75)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,177.63)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: Raleway, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,113.5)">20</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('<g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: Raleway, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Number of Graphs Made this Week</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>') > 0);
        });
      });
    });

    it('Bar Chart with Direct Labels', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#bar-chart-with-direct-labels example.
      const payload = `{
                         "data": [
                           {
                             "x": [ "Product A", "Product B", "Product C" ],
                             "y": [ 20, 14, 23 ],
                             "type": "bar",
                             "text": [ "20", "14", "23" ],
                             "textposition": "auto",
                             "hoverinfo": "none",
                             "marker": {
                               "color": "rgb(158,202,225)",
                               "opacity": 0.6,
                               "line": {
                                 "color": "rgb(8,48,107)",
                                 "width": 1.5
                               }
                             }
                           }
                         ],
                         "layout": {
                           "title": {
                             "text": "January 2013 Sales Report"
                           },
                           "barmode": "stack"
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based output would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-bd1b02"><g class="clips"><clipPath id="clipbd1b02xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clipbd1b02x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clipbd1b02y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clipbd1b02xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,314.24)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,258.48)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,202.72)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,146.96)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipbd1b02xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 0.6; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M18,270V46.96H162V270Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(90.00032043457031,61.96)">20</text></g><g class="point"><path style="vector-effect: none; opacity: 0.6; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M198,270V113.87H342V270Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(270.0003204345703,128.87)">14</text></g><g class="point"><path style="vector-effect: none; opacity: 0.6; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M378,270V13.5H522V270Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(450.0003204345703,28.5)">23</text></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">Product A</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">Product B</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">Product C</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,314.24)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,258.48)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,202.72)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,146.96)">20</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-bd1b02"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">January 2013 Sales Report</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Current server response is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-5f3d23"><g class="clips"><clipPath id="clip5f3d23xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip5f3d23x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip5f3d23y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip5f3d23xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,314.24)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,258.48)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,202.72)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,146.96)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip5f3d23xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 0.6; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M18,270V46.96H162V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.6; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M198,270V113.87H342V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.6; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M378,270V13.5H522V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">Product A</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">Product B</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">Product C</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,314.24)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,258.48)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,202.72)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,146.96)">20</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-5f3d23"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">January 2013 Sales Report</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,314.24)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,258.48)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,202.72)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,146.96)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 0.6; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M18,270V46.96H162V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.6; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M198,270V113.87H342V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.6; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M378,270V13.5H522V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">Product A</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">Product B</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">Product C</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,314.24)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,258.48)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,202.72)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,146.96)">20</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">January 2013 Sales Report</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>') > 0);
        });
      });
    });

    it('Grouped Bar Chart with Direct Labels', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#grouped-bar-chart-with-direct-labels example.
      const payload = `{
                         "data": [
                           {
                             "x": [ "Product A", "Product B", "Product C" ],
                             "y": [ 20, 14, 23 ],
                             "type": "bar",
                             "text": [ "20", "14", "23" ],
                             "textposition": "auto",
                             "hoverinfo": "none",
                             "opacity": 0.5,
                             "marker": {
                               "color": "rgb(158,202,225)",
                               "line": {
                                 "color": "rgb(8,48,107)",
                                 "width": 1.5
                               }
                             }
                           },
                           {
                             "x": [ "Product A", "Product B", "Product C" ],
                             "y": [ 24, 16, 20 ],
                             "type": "bar",
                             "text": [ "24", "16", "20" ],
                             "textposition": "auto",
                             "hoverinfo": "none",
                             "marker": {
                               "color": "rgba(58,200,225,.5)",
                               "line": {
                                 "color": "rgb(8,48,107)",
                                 "width": 1.5
                               }
                             }
                           }
                         ],
                         "layout": {
                           "title": {
                             "text": "January 2013 Sales Report"
                           }
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based output would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-e35127"><g class="clips"><clipPath id="clipe35127xyplot" class="plotclip"><rect width="514" height="270"/></clipPath><clipPath class="axesclip" id="clipe35127x"><rect x="80" y="0" width="514" height="450"/></clipPath><clipPath class="axesclip" id="clipe35127y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clipe35127xy"><rect x="80" y="100" width="514" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,316.56)" d="M80,0h514" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,263.13)" d="M80,0h514" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,209.69)" d="M80,0h514" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,156.25)" d="M80,0h514" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,102.81)" d="M80,0h514" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h514" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipe35127xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 0.5;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M17.13,270V56.25H85.67V270Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(51.40032043457031,71.25)">20</text></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M188.47,270V120.38H257V270Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(222.73532043457033,135.38)">14</text></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M359.8,270V24.19H428.33V270Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(394.0653204345703,39.19)">23</text></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M85.67,270V13.5H154.2V270Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(119.93532043457031,28.5)">24</text></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M257,270V99H325.53V270Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(291.2653204345703,114)">16</text></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M428.33,270V56.25H496.87V270Z"/><text class="bartext bartext-inside" text-anchor="middle" data-notex="1" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="0" y="0" transform="translate(462.60032043457034,71.25)">20</text></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(165.67000000000002,0)">Product A</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(337,0)">Product B</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(508.33,0)">Product C</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,316.56)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,263.13)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,209.69)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,156.25)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,102.81)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-e35127"><g class="clips"/><clipPath id="legende35127"><rect width="84" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(604.28,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="84" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legende35127)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">trace 0</text><g class="layers" style="opacity: 0.5;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="78.69999694824219" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">trace 1</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="78.69999694824219" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">January 2013 Sales Report</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Current server response is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-fe4a8a"><g class="clips"><clipPath id="clipfe4a8axyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clipfe4a8ax"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clipfe4a8ay"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clipfe4a8axy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,316.56)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,263.13)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,209.69)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,156.25)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,102.81)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipfe4a8axyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 0.5;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M18,270V56.25H90V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M198,270V120.38H270V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M378,270V24.19H450V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M90,270V13.5H162V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M270,270V99H342V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M450,270V56.25H522V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">Product A</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">Product B</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">Product C</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,316.56)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,263.13)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,209.69)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,156.25)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,102.81)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-fe4a8a"><g class="clips"/><clipPath id="legendfe4a8a"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legendfe4a8a)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">trace 0</text><g class="layers" style="opacity: 0.5;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">trace 1</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">January 2013 Sales Report</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,316.56)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,263.13)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,209.69)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,156.25)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,102.81)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 0.5;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M18,270V56.25H90V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M198,270V120.38H270V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M378,270V24.19H450V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M90,270V13.5H162V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M270,270V99H342V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;" d="M450,270V56.25H522V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">Product A</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">Product B</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">Product C</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,316.56)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,263.13)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,209.69)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,156.25)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,102.81)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/><clipPath id="legend') > 0);
          assert.ok(body.indexOf('"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend') > 0);
          assert.ok(body.indexOf(')"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">trace 0</text><g class="layers" style="opacity: 0.5;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 1.5px; fill: rgb(158, 202, 225); fill-opacity: 1; stroke: rgb(8, 48, 107); stroke-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">trace 1</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 1.5px; fill: rgb(58, 200, 225); fill-opacity: 0.5; stroke: rgb(8, 48, 107); stroke-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">January 2013 Sales Report</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>') > 0);
        });
      });
    });

    it('Bar Chart with Rotated Labels', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#bar-chart-with-rotated-labels example.
      const payload = `{
                         "data": [
                           {
                             "x": [ "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec" ],
                             "y": [ 20, 14, 25, 16, 18, 22, 19, 15, 12, 16, 14, 17 ],
                             "type": "bar",
                             "name": "Primary Product",
                             "marker": {
                               "color": "rgb(49,130,189)",
                               "opacity": 0.7
                             }
                           },
                           {
                             "x": [ "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec" ],
                             "y": [ 19, 14, 22, 14, 16, 19, 15, 14, 10, 12, 12, 16 ],
                             "type": "bar",
                             "name": "Secondary Product",
                             "marker": {
                               "color": "rgb(204,204,204)",
                               "opacity": 0.5
                             }
                           }
                         ],
                         "layout": {
                           "title": {
                             "text": "2013 Sales Report"
                           },
                           "xaxis": {
                             "tickangle": -45
                           },
                           "barmode": "group"
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based output would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-f9aefe"><g class="clips"><clipPath id="clipf9aefexyplot" class="plotclip"><rect width="450" height="270"/></clipPath><clipPath class="axesclip" id="clipf9aefex"><rect x="80" y="0" width="450" height="450"/></clipPath><clipPath class="axesclip" id="clipf9aefey"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clipf9aefexy"><rect x="80" y="100" width="450" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,318.7)" d="M80,0h450" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,267.4)" d="M80,0h450" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,216.1)" d="M80,0h450" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,164.8)" d="M80,0h450" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,113.5)" d="M80,0h450" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h450" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipf9aefexyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M3.75,270V64.8H18.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M41.25,270V126.36H56.25V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M78.75,270V13.5H93.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M116.25,270V105.84H131.25V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M153.75,270V85.32H168.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M191.25,270V44.28H206.25V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M228.75,270V75.06H243.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M266.25,270V116.1H281.25V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M303.75,270V146.88H318.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M341.25,270V105.84H356.25V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M378.75,270V126.36H393.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M416.25,270V95.58H431.25V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M18.75,270V75.06H33.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M56.25,270V126.36H71.25V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M93.75,270V44.28H108.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M131.25,270V126.36H146.25V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M168.75,270V105.84H183.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M206.25,270V75.06H221.25V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M243.75,270V116.1H258.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M281.25,270V126.36H296.25V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M318.75,270V167.4H333.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M356.25,270V146.88H371.25V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M393.75,270V146.88H408.75V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M431.25,270V105.84H446.25V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(98.75,0) rotate(-45,0,377)">Jan</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(136.25,0) rotate(-45,0,377)">Feb</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(173.75,0) rotate(-45,0,377)">Mar</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(211.25,0) rotate(-45,0,377)">Apr</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(248.75,0) rotate(-45,0,377)">May</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(286.25,0) rotate(-45,0,377)">Jun</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(323.75,0) rotate(-45,0,377)">Jul</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(361.25,0) rotate(-45,0,377)">Aug</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(398.75,0) rotate(-45,0,377)">Sep</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(436.25,0) rotate(-45,0,377)">Oct</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(473.75,0) rotate(-45,0,377)">Nov</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(511.25,0) rotate(-45,0,377)">Dec</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,318.7)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,267.4)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,216.1)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,164.8)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,113.5)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-f9aefe"><g class="clips"/><clipPath id="legendf9aefe"><rect width="149" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(539,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="149" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legendf9aefe)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Primary Product</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="144" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Secondary Product</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="144" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">2013 Sales Report</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Current server response is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-97790b"><g class="clips"><clipPath id="clip97790bxyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip97790bx"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip97790by"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip97790bxy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,318.7)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,267.4)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,216.1)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,164.8)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,113.5)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip97790bxyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M4.5,270V64.8H22.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M49.5,270V126.36H67.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M94.5,270V13.5H112.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M139.5,270V105.84H157.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M184.5,270V85.32H202.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M229.5,270V44.28H247.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M274.5,270V75.06H292.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M319.5,270V116.1H337.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M364.5,270V146.88H382.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M409.5,270V105.84H427.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M454.5,270V126.36H472.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M499.5,270V95.58H517.5V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M22.5,270V75.06H40.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M67.5,270V126.36H85.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M112.5,270V44.28H130.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M157.5,270V126.36H175.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M202.5,270V105.84H220.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M247.5,270V75.06H265.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M292.5,270V116.1H310.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M337.5,270V126.36H355.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M382.5,270V167.4H400.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M427.5,270V146.88H445.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M472.5,270V146.88H490.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M517.5,270V105.84H535.5V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(102.5,0) rotate(-45,0,377)">Jan</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(147.5,0) rotate(-45,0,377)">Feb</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(192.5,0) rotate(-45,0,377)">Mar</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(237.5,0) rotate(-45,0,377)">Apr</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(282.5,0) rotate(-45,0,377)">May</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(327.5,0) rotate(-45,0,377)">Jun</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(372.5,0) rotate(-45,0,377)">Jul</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(417.5,0) rotate(-45,0,377)">Aug</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(462.5,0) rotate(-45,0,377)">Sep</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(507.5,0) rotate(-45,0,377)">Oct</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(552.5,0) rotate(-45,0,377)">Nov</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(597.5,0) rotate(-45,0,377)">Dec</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,318.7)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,267.4)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,216.1)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,164.8)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,113.5)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-97790b"><g class="clips"/><clipPath id="legend97790b"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend97790b)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Primary Product</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Secondary Product</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">2013 Sales Report</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,318.7)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,267.4)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,216.1)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,164.8)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,113.5)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M4.5,270V64.8H22.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M49.5,270V126.36H67.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M94.5,270V13.5H112.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M139.5,270V105.84H157.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M184.5,270V85.32H202.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M229.5,270V44.28H247.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M274.5,270V75.06H292.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M319.5,270V116.1H337.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M364.5,270V146.88H382.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M409.5,270V105.84H427.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M454.5,270V126.36H472.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.7; stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;" d="M499.5,270V95.58H517.5V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M22.5,270V75.06H40.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M67.5,270V126.36H85.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M112.5,270V44.28H130.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M157.5,270V126.36H175.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M202.5,270V105.84H220.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M247.5,270V75.06H265.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M292.5,270V116.1H310.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M337.5,270V126.36H355.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M382.5,270V167.4H400.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M427.5,270V146.88H445.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M472.5,270V146.88H490.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 0.5; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M517.5,270V105.84H535.5V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(102.5,0) rotate(-45,0,377)">Jan</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(147.5,0) rotate(-45,0,377)">Feb</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(192.5,0) rotate(-45,0,377)">Mar</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(237.5,0) rotate(-45,0,377)">Apr</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(282.5,0) rotate(-45,0,377)">May</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(327.5,0) rotate(-45,0,377)">Jun</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(372.5,0) rotate(-45,0,377)">Jul</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(417.5,0) rotate(-45,0,377)">Aug</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(462.5,0) rotate(-45,0,377)">Sep</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(507.5,0) rotate(-45,0,377)">Oct</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(552.5,0) rotate(-45,0,377)">Nov</text></g><g class="xtick"><text text-anchor="end" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(597.5,0) rotate(-45,0,377)">Dec</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,318.7)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,267.4)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,216.1)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,164.8)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,113.5)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/><clipPath id="legend') > 0);
          assert.ok(body.indexOf('"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend') > 0);
          assert.ok(body.indexOf(')"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Primary Product</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(49, 130, 189); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Secondary Product</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">2013 Sales Report</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>') > 0);
        });
      });
    });

    it('Customizing Individual Bar Colours', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#customizing-individual-bar-colors example.
      const payload = `{
                         "data": [
                           {
                             "x": [ "Feature A", "Feature B", "Feature C", "Feature D", "Feature E" ],
                             "y": [ 20, 14, 23, 25, 22 ],
                             "marker": {
                               "color": [
                                 "rgba(204,204,204,1)", "rgba(222,45,38,0.8)", "rgba(204,204,204,1)", "rgba(204,204,204,1)", "rgba(204,204,204,1)" ]
                             },
                             "type": "bar"
                           }
                         ],
                         "layout": {
                           "title": {
                             "text": "Least Used Feature"
                           }
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based answer would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-db3ed4"><g class="clips"><clipPath id="clipdb3ed4xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clipdb3ed4x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clipdb3ed4y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clipdb3ed4xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,318.7)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,267.4)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,216.1)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,164.8)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,113.5)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipdb3ed4xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M10.8,270V64.8H97.2V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(222, 45, 38); fill-opacity: 0.8;" d="M118.8,270V126.36H205.2V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M226.8,270V34.02H313.2V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M334.8,270V13.5H421.2V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M442.8,270V44.28H529.2V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(134,0)">Feature A</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(242,0)">Feature B</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">Feature C</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(458,0)">Feature D</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(566,0)">Feature E</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,318.7)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,267.4)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,216.1)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,164.8)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,113.5)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-db3ed4"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Least Used Feature</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Current server response is virtually the same, apart from random ids.

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,318.7)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,267.4)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,216.1)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,164.8)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,113.5)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M10.8,270V64.8H97.2V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(222, 45, 38); fill-opacity: 0.8;" d="M118.8,270V126.36H205.2V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M226.8,270V34.02H313.2V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M334.8,270V13.5H421.2V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(204, 204, 204); fill-opacity: 1;" d="M442.8,270V44.28H529.2V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(134,0)">Feature A</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(242,0)">Feature B</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">Feature C</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(458,0)">Feature D</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(566,0)">Feature E</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,318.7)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,267.4)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,216.1)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,164.8)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,113.5)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs') > 0);
          assert.ok(body.indexOf('<g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Least Used Feature</text></g><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>') > 0);
        });
      });
    });

    it('Customizing Individual Bar Widths', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#customizing-individual-bar-widths example.
      const payload = `[
                         {
                           "type": "bar",
                           "x": [ 1, 2, 3, 5.5, 10 ],
                           "y": [ 10, 8, 6, 4, 2 ],
                           "width": [ 0.8, 0.8, 0.8, 3.5, 4 ]
                         }
                       ]`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based answer would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="400" style="" viewBox="0 0 700 400"><rect x="0" y="0" width="700" height="400" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-02c3ef"><g class="clips"><clipPath id="clip02c3efxyplot" class="plotclip"><rect width="540" height="220"/></clipPath><clipPath class="axesclip" id="clip02c3efx"><rect x="80" y="0" width="540" height="400"/></clipPath><clipPath class="axesclip" id="clip02c3efy"><rect x="0" y="100" width="700" height="220"/></clipPath><clipPath class="axesclip" id="clip02c3efxy"><rect x="80" y="100" width="540" height="220"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,278.2)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,236.4)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,194.6)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,152.8)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,111)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,320)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip02c3efxyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M4.7,220V11H42.26V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M51.65,220V52.8H89.22V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M98.61,220V94.6H136.17V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M152.61,220V136.4H316.96V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M352.17,220V178.2H540V220Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(150.43,0)">2</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(244.35,0)">4</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(338.26,0)">6</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(432.17,0)">8</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(526.0899999999999,0)">10</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(620,0)">12</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,320)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,278.2)">2</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,236.4)">4</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,194.6)">6</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,152.8)">8</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,111)">10</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-02c3ef"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Current server response is virtually the same, apart from random ids.

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="400" style="" viewBox="0 0 700 400"><rect x="0" y="0" width="700" height="400" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="220"/></clipPath><clipPath class="axesclip" id="cli') > 0);
          assert.ok(body.indexOf('<rect x="80" y="0" width="540" height="400"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="0" y="100" width="700" height="220"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('<rect x="80" y="100" width="540" height="220"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,278.2)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,236.4)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,194.6)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,152.8)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,111)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,320)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M4.7,220V11H42.26V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M51.65,220V52.8H89.22V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M98.61,220V94.6H136.17V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M152.61,220V136.4H316.96V220Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M352.17,220V178.2H540V220Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(150.43,0)">2</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(244.35,0)">4</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(338.26,0)">6</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(432.17,0)">8</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(526.0899999999999,0)">10</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(620,0)">12</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,320)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,278.2)">2</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,236.4)">4</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,194.6)">6</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,152.8)">8</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,111)">10</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('<g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>') > 0);
        });
      });
    });

    it('Customizing Individual Bar Base', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#customizing-individual-bar-base example.
      const payload = `[
                         {
                           "type": "bar",
                           "x": [ "2016", "2017", "2018" ],
                           "y": [ 500, 600, 700 ],
                           "base": [ -500, -600, -700 ],
                           "hovertemplate": "%{base}",
                           "marker": {
                             "color": "red"
                           },
                           "name": "expenses"
                         },
                         {
                           "type": "bar",
                           "x": [ "2016", "2017", "2018" ],
                           "y": [ 300, 400, 700 ],
                           "base": 0,
                           "marker": {
                             "color": "blue"
                           },
                           "name": "revenue"
                         }
                       ]`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based output would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="400" style="" viewBox="0 0 700 400"><rect x="0" y="0" width="700" height="400" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-b372a5"><g class="clips"><clipPath id="clipb372a5xyplot" class="plotclip"><rect width="499" height="220"/></clipPath><clipPath class="axesclip" id="clipb372a5x"><rect x="80" y="0" width="499" height="400"/></clipPath><clipPath class="axesclip" id="clipb372a5y"><rect x="0" y="100" width="700" height="220"/></clipPath><clipPath class="axesclip" id="clipb372a5xy"><rect x="80" y="100" width="499" height="220"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,280.71000000000004)" d="M80,0h499" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,139.29)" d="M80,0h499" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,210)" d="M80,0h499" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipb372a5xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;" d="M16.63,180.71V110H83.17V180.71Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;" d="M182.97,194.86V110H249.5V194.86Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;" d="M349.3,209V110H415.83V209Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;" d="M83.17,110V67.57H149.7V110Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;" d="M249.5,110V53.43H316.03V110Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;" d="M415.83,110V11H482.37V110Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(163.17000000000002,0)">2016</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(329.5,0)">2017</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(495.83,0)">2018</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,280.71000000000004)">500</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,210)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,139.29)">500</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-b372a5"><g class="clips"/><clipPath id="legendb372a5"><rect width="99" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(588.98,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="99" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legendb372a5)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">expenses</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="93.33332824707031" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">revenue</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="93.33332824707031" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Current server response is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="400" style="" viewBox="0 0 700 400"><rect x="0" y="0" width="700" height="400" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-5f3046"><g class="clips"><clipPath id="clip5f3046xyplot" class="plotclip"><rect width="540" height="220"/></clipPath><clipPath class="axesclip" id="clip5f3046x"><rect x="80" y="0" width="540" height="400"/></clipPath><clipPath class="axesclip" id="clip5f3046y"><rect x="0" y="100" width="700" height="220"/></clipPath><clipPath class="axesclip" id="clip5f3046xy"><rect x="80" y="100" width="540" height="220"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,280.71000000000004)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,139.29)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,210)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip5f3046xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;" d="M18,180.71V110H90V180.71Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;" d="M198,194.86V110H270V194.86Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;" d="M378,209V110H450V209Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;" d="M90,110V67.57H162V110Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;" d="M270,110V53.43H342V110Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;" d="M450,110V11H522V110Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">2016</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">2017</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">2018</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,280.71000000000004)">500</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,210)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,139.29)">500</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-5f3046"><g class="clips"/><clipPath id="legend5f3046"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend5f3046)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">expenses</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">revenue</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="400" style="" viewBox="0 0 700 400"><rect x="0" y="0" width="700" height="400" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="220"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('x"><rect x="80" y="0" width="540" height="400"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('y"><rect x="0" y="100" width="700" height="220"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('xy"><rect x="80" y="100" width="540" height="220"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,280.71000000000004)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,139.29)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,210)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;" d="M18,180.71V110H90V180.71Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;" d="M198,194.86V110H270V194.86Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;" d="M378,209V110H450V209Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;" d="M90,110V67.57H162V110Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;" d="M270,110V53.43H342V110Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;" d="M450,110V11H522V110Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">2016</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">2017</text></g><g class="xtick"><text text-anchor="middle" x="0" y="333" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">2018</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,280.71000000000004)">500</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,210)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,139.29)">500</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/><clipPath id="legend') > 0);
          assert.ok(body.indexOf('"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend') > 0);
          assert.ok(body.indexOf(')"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">expenses</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 0, 0); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">revenue</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(0, 0, 255); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"/><g class="g-xtitle"/><g class="g-ytitle"/></g></svg>') > 0);
        });
      });
    });

    it('Rounded Corners on Bars', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#rounded-corners-on-bars example.
      const payload = `{
                         "data": [
                           {
                             "x": [ "South Korea", "China", "Canada" ],
                             "y": [ 24, 10, 9 ],
                             "name": "Gold",
                             "type": "bar"
                           },
                           {
                             "x": [ "South Korea", "China", "Canada" ],
                             "y": [ 13, 15, 12 ],
                             "name": "Silver",
                             "type": "bar"
                           },
                           {
                             "x": [ "South Korea", "China", "Canada" ],
                             "y": [ 11, 8, 12 ],
                             "name": "Bronze",
                             "type": "bar"
                           }
                         ],
                         "layout": {
                           "scattermode": "group",
                           "title": {
                             "text": "Grouped by Country"
                           },
                           "xaxis": {
                             "title": {
                               "text": "Country"
                             }
                           },
                           "yaxis": {
                             "title": {
                               "text": "Medals"
                             }
                           },
                           "barcornerradius": 15
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based output would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-9ad422"><g class="clips"><clipPath id="clip9ad422xyplot" class="plotclip"><rect width="513" height="270"/></clipPath><clipPath class="axesclip" id="clip9ad422x"><rect x="80" y="0" width="513" height="450"/></clipPath><clipPath class="axesclip" id="clip9ad422y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip9ad422xy"><rect x="80" y="100" width="513" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,316.56)" d="M80,0h513" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,263.13)" d="M80,0h513" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,209.69)" d="M80,0h513" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,156.25)" d="M80,0h513" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,102.81)" d="M80,0h513" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h513" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip9ad422xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M17.1,270V28.5A 15,15 0 0 1 32.1,13.5H47.7A 15,15 0 0 1 62.7,28.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M188.1,270V178.13A 15,15 0 0 1 203.1,163.13H218.7A 15,15 0 0 1 233.7,178.13V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M359.1,270V188.81A 15,15 0 0 1 374.1,173.81H389.7A 15,15 0 0 1 404.7,188.81V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M62.7,270V146.06A 15,15 0 0 1 77.7,131.06H93.3A 15,15 0 0 1 108.3,146.06V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M233.7,270V124.69A 15,15 0 0 1 248.7,109.69H264.3A 15,15 0 0 1 279.3,124.69V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M404.7,270V156.75A 15,15 0 0 1 419.7,141.75H435.3A 15,15 0 0 1 450.3,156.75V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;" d="M108.3,270V167.44A 15,15 0 0 1 123.3,152.44H138.9A 15,15 0 0 1 153.9,167.44V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;" d="M279.3,270V199.5A 15,15 0 0 1 294.3,184.5H309.9A 15,15 0 0 1 324.9,199.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;" d="M450.3,270V156.75A 15,15 0 0 1 465.3,141.75H480.9A 15,15 0 0 1 495.9,156.75V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(165.5,0)">South Korea</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(336.5,0)">China</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(507.5,0)">Canada</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,316.56)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,263.13)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,209.69)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,156.25)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,102.81)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-9ad422"><g class="clips"/><clipPath id="legend9ad422"><rect width="85" height="67" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(603.26,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="85" height="67" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend9ad422)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Gold</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,3a3,3,0,0,1-3,3H-3a3,3,0,0,1-3-3V-3a3,3,0,0,1,3-3H3a3,3,0,0,1,3,3Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="80" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Silver</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,3a3,3,0,0,1-3,3H-3a3,3,0,0,1-3-3V-3a3,3,0,0,1,3-3H3a3,3,0,0,1,3,3Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="80" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,52.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Bronze</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,3a3,3,0,0,1-3,3H-3a3,3,0,0,1-3-3V-3a3,3,0,0,1,3-3H3a3,3,0,0,1,3,3Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="80" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Grouped by Country</text></g><g class="g-xtitle"><text class="xtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="336.5" y="422" text-anchor="middle">Country</text></g><g class="g-ytitle"><text class="ytitle" transform="rotate(-90,42,235)" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="42" y="235" text-anchor="middle">Medals</text></g></g></svg>

          // Current server response is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-02c823"><g class="clips"><clipPath id="clip02c823xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip02c823x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip02c823y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip02c823xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,316.56)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,263.13)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,209.69)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,156.25)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,102.81)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip02c823xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M18,270V28.5A 15,15 0 0 1 33,13.5H51A 15,15 0 0 1 66,28.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M198,270V178.13A 15,15 0 0 1 213,163.13H231A 15,15 0 0 1 246,178.13V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M378,270V188.81A 15,15 0 0 1 393,173.81H411A 15,15 0 0 1 426,188.81V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M66,270V146.06A 15,15 0 0 1 81,131.06H99A 15,15 0 0 1 114,146.06V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M246,270V124.69A 15,15 0 0 1 261,109.69H279A 15,15 0 0 1 294,124.69V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M426,270V156.75A 15,15 0 0 1 441,141.75H459A 15,15 0 0 1 474,156.75V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;" d="M114,270V167.44A 15,15 0 0 1 129,152.44H147A 15,15 0 0 1 162,167.44V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;" d="M294,270V199.5A 15,15 0 0 1 309,184.5H327A 15,15 0 0 1 342,199.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;" d="M474,270V156.75A 15,15 0 0 1 489,141.75H507A 15,15 0 0 1 522,156.75V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">South Korea</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">China</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">Canada</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,316.56)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,263.13)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,209.69)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,156.25)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,102.81)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-02c823"><g class="clips"/><clipPath id="legend02c823"><rect width="45" height="67" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="67" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend02c823)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Gold</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,3a3,3,0,0,1-3,3H-3a3,3,0,0,1-3-3V-3a3,3,0,0,1,3-3H3a3,3,0,0,1,3,3Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Silver</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,3a3,3,0,0,1-3,3H-3a3,3,0,0,1-3-3V-3a3,3,0,0,1,3-3H3a3,3,0,0,1,3,3Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,52.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Bronze</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,3a3,3,0,0,1-3,3H-3a3,3,0,0,1-3-3V-3a3,3,0,0,1,3-3H3a3,3,0,0,1,3,3Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Grouped by Country</text></g><g class="g-xtitle"><text class="xtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="422" text-anchor="middle">Country</text></g><g class="g-ytitle"><text class="ytitle" transform="rotate(-90,42,235)" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="42" y="235" text-anchor="middle">Medals</text></g></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,316.56)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,263.13)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,209.69)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,156.25)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,102.81)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M18,270V28.5A 15,15 0 0 1 33,13.5H51A 15,15 0 0 1 66,28.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M198,270V178.13A 15,15 0 0 1 213,163.13H231A 15,15 0 0 1 246,178.13V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;" d="M378,270V188.81A 15,15 0 0 1 393,173.81H411A 15,15 0 0 1 426,188.81V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M66,270V146.06A 15,15 0 0 1 81,131.06H99A 15,15 0 0 1 114,146.06V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M246,270V124.69A 15,15 0 0 1 261,109.69H279A 15,15 0 0 1 294,124.69V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;" d="M426,270V156.75A 15,15 0 0 1 441,141.75H459A 15,15 0 0 1 474,156.75V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;" d="M114,270V167.44A 15,15 0 0 1 129,152.44H147A 15,15 0 0 1 162,167.44V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;" d="M294,270V199.5A 15,15 0 0 1 309,184.5H327A 15,15 0 0 1 342,199.5V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;" d="M474,270V156.75A 15,15 0 0 1 489,141.75H507A 15,15 0 0 1 522,156.75V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(170,0)">South Korea</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(350,0)">China</text></g><g class="xtick"><text text-anchor="middle" x="0" y="383" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(530,0)">Canada</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,316.56)">5</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,263.13)">10</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,209.69)">15</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,156.25)">20</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,102.81)">25</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/><clipPath id="legend') > 0);
          assert.ok(body.indexOf('"><rect width="45" height="67" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(630.8,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; fill: rgb(255, 255, 255); fill-opacity: 1; stroke-width: 0px;" width="45" height="67" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend') > 0);
          assert.ok(body.indexOf(')"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Gold</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,3a3,3,0,0,1-3,3H-3a3,3,0,0,1-3-3V-3a3,3,0,0,1,3-3H3a3,3,0,0,1,3,3Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(31, 119, 180); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Silver</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,3a3,3,0,0,1-3,3H-3a3,3,0,0,1-3-3V-3a3,3,0,0,1,3-3H3a3,3,0,0,1,3,3Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(255, 127, 14); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,52.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Bronze</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,3a3,3,0,0,1-3,3H-3a3,3,0,0,1-3-3V-3a3,3,0,0,1,3-3H3a3,3,0,0,1,3,3Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(44, 160, 44); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">Grouped by Country</text></g><g class="g-xtitle"><text class="xtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="422" text-anchor="middle">Country</text></g><g class="g-ytitle"><text class="ytitle" transform="rotate(-90,42,235)" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="42" y="235" text-anchor="middle">Medals</text></g></g></svg>') > 0);
        });
      });
    });

    it('Colored and Styled Bar Chart', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#colored-and-styled-bar-chart example.
      const payload = `{
                         "data": [
                           {
                             "x": [ 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012 ],
                             "y": [ 219, 146, 112, 127, 124, 180, 236, 207, 236, 263, 350, 430, 474, 526, 488, 537, 500, 439 ],
                             "name": "Rest of world",
                             "marker": {
                               "color": "rgb(55, 83, 109)"
                             },
                             "type": "bar"
                           },
                           {
                             "x": [ 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012 ],
                             "y": [ 16, 13, 10, 11, 28, 37, 43, 55, 56, 88, 105, 156, 270, 299, 340, 403, 549, 499 ],
                             "name": "China",
                             "marker": {
                               "color": "rgb(26, 118, 255)"
                             },
                             "type": "bar"
                           }
                         ],
                         "layout": {
                           "title": {
                             "text": "US Export of Plastic Scrap"
                           },
                           "xaxis": {
                             "tickfont": {
                               "size": 14,
                               "color": "rgb(107, 107, 107)"
                             }
                           },
                           "yaxis": {
                             "title": {
                               "text": "USD (millions)",
                               "font": {
                                 "size": 16,
                                 "color": "rgb(107, 107, 107)"
                               }
                             },
                             "tickfont": {
                               "size": 14,
                               "color": "rgb(107, 107, 107)"
                             }
                           },
                           "legend": {
                             "x": 0,
                             "y": 1,
                             "bgcolor": "rgba(255, 255, 255, 0)",
                             "bordercolor": "rgba(255, 255, 255, 0)"
                           },
                           "barmode": "group",
                           "bargap": 0.15,
                           "bargroupgap": 0.1
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based output would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-e96e7c"><g class="clips"><clipPath id="clipe96e7cxyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clipe96e7cx"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clipe96e7cy"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clipe96e7cxy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,323.28)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,276.56)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,229.84)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,183.11)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,136.39)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clipe96e7cxyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M2.89,270V167.68H14.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M32.89,270V201.79H44.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M62.89,270V217.67H74.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M92.89,270V210.66H104.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M122.89,270V212.07H134.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M152.89,270V185.9H164.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M182.89,270V159.74H194.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M212.89,270V173.29H224.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M242.89,270V159.74H254.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M272.89,270V147.12H284.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M302.89,270V106.48H314.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M332.89,270V69.1H344.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M362.89,270V48.54H374.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M392.89,270V24.25H404.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M422.89,270V42H434.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M452.89,270V19.11H464.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M482.89,270V36.39H494.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M512.89,270V64.89H524.36V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M15.64,270V262.52H27.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M45.64,270V263.93H57.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M75.64,270V265.33H87.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M105.64,270V264.86H117.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M135.64,270V256.92H147.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M165.64,270V252.71H177.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M195.64,270V249.91H207.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M225.64,270V244.3H237.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M255.64,270V243.84H267.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M285.64,270V228.89H297.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M315.64,270V220.94H327.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M345.64,270V197.11H357.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M375.64,270V143.85H387.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M405.64,270V130.3H417.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M435.64,270V111.15H447.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M465.64,270V81.71H477.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M495.64,270V13.5H507.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M525.64,270V36.86H537.11V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(95,0)">1995</text></g><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(245,0)">2000</text></g><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(395,0)">2005</text></g><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(545,0)">2010</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,323.28)">100</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,276.56)">200</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,229.84)">300</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,183.11)">400</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,136.39)">500</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-e96e7c"><g class="clips"/><clipPath id="legende96e7c"><rect width="117" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(80,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(255, 255, 255); stroke-opacity: 0; fill: rgb(255, 255, 255); fill-opacity: 0; stroke-width: 0px;" width="117" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legende96e7c)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Rest of world</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="112" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">China</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="112" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">US Export of Plastic Scrap</text></g><g class="g-xtitle"/><g class="g-ytitle"><text class="ytitle" transform="rotate(-90,38,235)" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 16px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre;" x="38" y="235" text-anchor="middle">USD (millions)</text></g></g></svg>

          // Current server response is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-26d7cb"><g class="clips"><clipPath id="clip26d7cbxyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip26d7cbx"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip26d7cby"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip26d7cbxy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,323.28)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,276.56)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,229.84)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,183.11)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,136.39)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip26d7cbxyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M2.89,270V167.68H14.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M32.89,270V201.79H44.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M62.89,270V217.67H74.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M92.89,270V210.66H104.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M122.89,270V212.07H134.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M152.89,270V185.9H164.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M182.89,270V159.74H194.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M212.89,270V173.29H224.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M242.89,270V159.74H254.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M272.89,270V147.12H284.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M302.89,270V106.48H314.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M332.89,270V69.1H344.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M362.89,270V48.54H374.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M392.89,270V24.25H404.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M422.89,270V42H434.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M452.89,270V19.11H464.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M482.89,270V36.39H494.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M512.89,270V64.89H524.36V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M15.64,270V262.52H27.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M45.64,270V263.93H57.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M75.64,270V265.33H87.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M105.64,270V264.86H117.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M135.64,270V256.92H147.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M165.64,270V252.71H177.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M195.64,270V249.91H207.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M225.64,270V244.3H237.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M255.64,270V243.84H267.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M285.64,270V228.89H297.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M315.64,270V220.94H327.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M345.64,270V197.11H357.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M375.64,270V143.85H387.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M405.64,270V130.3H417.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M435.64,270V111.15H447.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M465.64,270V81.71H477.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M495.64,270V13.5H507.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M525.64,270V36.86H537.11V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(95,0)">1995</text></g><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(245,0)">2000</text></g><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(395,0)">2005</text></g><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(545,0)">2010</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,323.28)">100</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,276.56)">200</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,229.84)">300</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,183.11)">400</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,136.39)">500</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-26d7cb"><g class="clips"/><clipPath id="legend26d7cb"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(80,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(255, 255, 255); stroke-opacity: 0; fill: rgb(255, 255, 255); fill-opacity: 0; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend26d7cb)"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Rest of world</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">China</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">US Export of Plastic Scrap</text></g><g class="g-xtitle"/><g class="g-ytitle"><text class="ytitle" transform="rotate(-90,38,235)" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 16px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre;" x="38" y="235" text-anchor="middle">USD (millions)</text></g></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="540" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('x"><rect x="80" y="0" width="540" height="450"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('y"><rect x="0" y="100" width="700" height="270"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('xy"><rect x="80" y="100" width="540" height="270"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,323.28)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,276.56)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,229.84)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,183.11)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,136.39)" d="M80,0h540" style="stroke: rgb(238, 238, 238); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,370)" d="M80,0h540" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M2.89,270V167.68H14.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M32.89,270V201.79H44.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M62.89,270V217.67H74.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M92.89,270V210.66H104.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M122.89,270V212.07H134.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M152.89,270V185.9H164.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M182.89,270V159.74H194.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M212.89,270V173.29H224.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M242.89,270V159.74H254.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M272.89,270V147.12H284.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M302.89,270V106.48H314.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M332.89,270V69.1H344.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M362.89,270V48.54H374.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M392.89,270V24.25H404.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M422.89,270V42H434.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M452.89,270V19.11H464.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M482.89,270V36.39H494.36V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;" d="M512.89,270V64.89H524.36V270Z"/></g></g></g><g class="trace bars" style="opacity: 1;"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M15.64,270V262.52H27.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M45.64,270V263.93H57.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M75.64,270V265.33H87.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M105.64,270V264.86H117.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M135.64,270V256.92H147.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M165.64,270V252.71H177.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M195.64,270V249.91H207.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M225.64,270V244.3H237.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M255.64,270V243.84H267.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M285.64,270V228.89H297.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M315.64,270V220.94H327.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M345.64,270V197.11H357.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M375.64,270V143.85H387.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M405.64,270V130.3H417.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M435.64,270V111.15H447.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M465.64,270V81.71H477.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M495.64,270V13.5H507.11V270Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;" d="M525.64,270V36.86H537.11V270Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(95,0)">1995</text></g><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(245,0)">2000</text></g><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(395,0)">2005</text></g><g class="xtick"><text text-anchor="middle" x="0" y="385" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(545,0)">2010</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,323.28)">100</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,276.56)">200</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,229.84)">300</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,183.11)">400</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.8999999999999995" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,136.39)">500</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/><clipPath id="legend') > 0);
          assert.ok(body.indexOf('"><rect width="45" height="48" x="0" y="0"/></clipPath></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="legend" pointer-events="all" transform="translate(80,100)"><rect class="bg" shape-rendering="crispEdges" style="stroke: rgb(255, 255, 255); stroke-opacity: 0; fill: rgb(255, 255, 255); fill-opacity: 0; stroke-width: 0px;" width="45" height="48" x="0" y="0"/><g class="scrollbox" transform="" clip-path="url(#legend') > 0);
          assert.ok(body.indexOf(')"><g class="groups"><g class="traces" style="opacity: 1;" transform="translate(0,14.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">Rest of world</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(55, 83, 109); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g><g class="traces" style="opacity: 1;" transform="translate(0,33.5)"><text class="legendtext" text-anchor="start" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="40" y="4.680000000000001">China</text><g class="layers" style="opacity: 1;"><g class="legendfill"/><g class="legendlines"/><g class="legendsymbols"><g class="legendpoints"><path class="legendundefined" d="M6,6H-6V-6H6Z" transform="translate(20,0)" style="stroke-width: 0px; fill: rgb(26, 118, 255); fill-opacity: 1;"/></g></g></g><rect class="legendtoggle" style="fill: rgb(0, 0, 0); fill-opacity: 0;" x="0" y="-9.5" width="40" height="19"/></g></g></g><rect class="scrollbar" rx="20" ry="3" width="0" height="0" style="fill: rgb(128, 139, 164); fill-opacity: 1;" x="0" y="0"/></g><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="50" text-anchor="middle" dy="0em">US Export of Plastic Scrap</text></g><g class="g-xtitle"/><g class="g-ytitle"><text class="ytitle" transform="rotate(-90,38,235)" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 16px; fill: rgb(107, 107, 107); fill-opacity: 1; white-space: pre;" x="38" y="235" text-anchor="middle">USD (millions)</text></g></g></svg>') > 0);
        });
      });
    });

    it('Waterfall Bar Chart', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/bar-charts/#colored-and-styled-bar-chart example.
      const payload = `{
                         "data": [
                           {
                             "x": [ "Product<br>Revenue", "Services<br>Revenue", "Total<br>Revenue", "Fixed<br>Costs", "Variable<br>Costs", "Total<br>Costs", "Total" ],
                             "y": [ 0, 430, 0, 570, 370, 370, 0 ],
                             "marker": {
                               "color": "rgba(1,1,1,0.0)"
                             },
                             "type": "bar"
                           },
                           {
                             "x": [ "Product<br>Revenue", "Services<br>Revenue", "Total<br>Revenue", "Fixed<br>Costs", "Variable<br>Costs", "Total<br>Costs", "Total" ],
                             "y": [ 430, 260, 690, 0, 0, 0, 0 ],
                             "type": "bar",
                             "marker": {
                               "color": "rgba(55,128,191,0.7)",
                               "line": {
                                 "color": "rgba(55,128,191,1.0)",
                                 "width": 2
                               }
                             }
                           },
                           {
                             "x": [ "Product<br>Revenue", "Services<br>Revenue", "Total<br>Revenue", "Fixed<br>Costs", "Variable<br>Costs", "Total<br>Costs", "Total" ],
                             "y": [ 0, 0, 0, 120, 200, 320, 0 ],
                             "type": "bar",
                             "marker": {
                               "color": "rgba(219, 64, 82, 0.7)",
                               "line": {
                                 "color": "rgba(219, 64, 82, 1.0)",
                                 "width": 2
                               }
                             }
                           },
                           {
                             "x": [ "Product<br>Revenue", "Services<br>Revenue", "Total<br>Revenue", "Fixed<br>Costs", "Variable<br>Costs", "Total<br>Costs", "Total" ],
                             "y": [ 0, 0, 0, 0, 0, 0, 370 ],
                             "type": "bar",
                             "marker": {
                               "color": "rgba(50,171, 96, 0.7)",
                               "line": {
                                 "color": "rgba(50,171,96,1.0)",
                                 "width": 2
                               }
                             }
                           }
                         ],
                         "layout": {
                           "title": {
                             "text": "Annual Profit 2015"
                           },
                           "barmode": "stack",
                           "paper_bgcolor": "rgba(245,246,249,1)",
                           "plot_bgcolor": "rgba(245,246,249,1)",
                           "width": 600,
                           "height": 600,
                           "showlegend": false,
                           "annotations": [
                             {
                               "x": "Product<br>Revenue",
                               "y": 400,
                               "text": "$430K",
                               "font": {
                                 "family": "Arial",
                                 "size": 14,
                                 "color": "rgba(245,246,249,1)"
                               },
                               "showarrow": false
                             },
                             {
                               "x": "Services<br>Revenue",
                               "y": 660,
                               "text": "$260K",
                               "font": {
                                 "family": "Arial",
                                 "size": 14,
                                 "color": "rgba(245,246,249,1)"
                               },
                               "showarrow": false
                             },
                             {
                               "x": "Total<br>Revenue",
                               "y": 660,
                               "text": "$690K",
                               "font": {
                                 "family": "Arial",
                                 "size": 14,
                                 "color": "rgba(245,246,249,1)"
                               },
                               "showarrow": false
                             },
                             {
                               "x": "Fixed<br>Costs",
                               "y": 590,
                               "text": "$-120K",
                               "font": {
                                 "family": "Arial",
                                 "size": 14,
                                 "color": "rgba(245,246,249,1)"
                               },
                               "showarrow": false
                             },
                             {
                               "x": "Variable<br>Costs",
                               "y": 400,
                               "text": "$-200K",
                               "font": {
                                 "family": "Arial",
                                 "size": 14,
                                 "color": "rgba(245,246,249,1)"
                               },
                               "showarrow": false
                             },
                             {
                               "x": "Total<br>Costs",
                               "y": 400,
                               "text": "$-320K",
                               "font": {
                                 "family": "Arial",
                                 "size": 14,
                                 "color": "rgba(245,246,249,1)"
                               },
                               "showarrow": false
                             },
                             {
                               "x": "Total",
                               "y": 340,
                               "text": "$370K",
                               "font": {
                                 "family": "Arial",
                                 "size": 14,
                                 "color": "rgba(245,246,249,1)"
                               },
                               "showarrow": false
                             }
                           ]
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based output would be something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="600" style="" viewBox="0 0 600 600"><rect x="0" y="0" width="600" height="600" style="fill: rgb(245, 246, 249); fill-opacity: 1;"/><defs id="defs-2d47df"><g class="clips"><clipPath id="clip2d47dfxyplot" class="plotclip"><rect width="440" height="420"/></clipPath><clipPath class="axesclip" id="clip2d47dfx"><rect x="80" y="0" width="440" height="600"/></clipPath><clipPath class="axesclip" id="clip2d47dfy"><rect x="0" y="100" width="600" height="420"/></clipPath><clipPath class="axesclip" id="clip2d47dfxy"><rect x="80" y="100" width="440" height="420"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,462.17)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,404.35)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,346.52)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,288.7)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,230.87)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,173.04000000000002)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,115.22)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,520)" d="M80,0h440" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip2d47dfxyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M0,0Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M69.14,420V171.35H119.43V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M0,0Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M194.86,420V90.39H245.14V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M257.71,420V206.04H308V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M320.57,420V206.04H370.86V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M0,0Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M6.29,420V171.35H56.57V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M69.14,171.35V21H119.43V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M132,420V21H182.29V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M194.86,90.39V90.39H245.14V90.39Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M257.71,206.04V206.04H308V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M320.57,206.04V206.04H370.86V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M383.43,420V420H433.71V420Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M6.29,171.35V171.35H56.57V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M69.14,21V21H119.43V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M132,21V21H182.29V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M194.86,90.39V21H245.14V90.39Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M257.71,206.04V90.39H308V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M320.57,206.04V21H370.86V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M383.43,420V420H433.71V420Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M6.29,171.35V171.35H56.57V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M69.14,21V21H119.43V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M132,21V21H182.29V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M194.86,21V21H245.14V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M257.71,90.39V90.39H308V90.39Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M320.57,21V21H370.86V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M383.43,420V206.04H433.71V420Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(111.43,0)"><tspan class="line" dy="0em" x="0" y="533">Product</tspan><tspan class="line" dy="1.3em" x="0" y="533">Revenue</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(174.29000000000002,0)"><tspan class="line" dy="0em" x="0" y="533">Services</tspan><tspan class="line" dy="1.3em" x="0" y="533">Revenue</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(237.14,0)"><tspan class="line" dy="0em" x="0" y="533">Total</tspan><tspan class="line" dy="1.3em" x="0" y="533">Revenue</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(300,0)"><tspan class="line" dy="0em" x="0" y="533">Fixed</tspan><tspan class="line" dy="1.3em" x="0" y="533">Costs</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(362.86,0)"><tspan class="line" dy="0em" x="0" y="533">Variable</tspan><tspan class="line" dy="1.3em" x="0" y="533">Costs</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(425.71,0)"><tspan class="line" dy="0em" x="0" y="533">Total</tspan><tspan class="line" dy="1.3em" x="0" y="533">Costs</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(488.57,0)">Total</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,520)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,462.17)">100</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,404.35)">200</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,346.52)">300</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,288.7)">400</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,230.87)">500</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,173.04000000000002)">600</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,115.22)">700</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-2d47df"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="300" y="50" text-anchor="middle" dy="0em">Annual Profit 2015</text></g><g class="g-xtitle"/><g class="g-ytitle"/><g class="annotation" data-index="0" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,111.43,288.7)"><g class="cursor-pointer" transform="translate(88,278)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="46" height="21"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="23.25" y="16">$430K</text></g></g></g><g class="annotation" data-index="1" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,174.29000000000002,138.35)"><g class="cursor-pointer" transform="translate(151,127)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="46" height="21"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="23.25" y="16">$260K</text></g></g></g><g class="annotation" data-index="2" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,237.14,138.35)"><g class="cursor-pointer" transform="translate(214,127)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="46" height="21"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="23.25" y="16">$690K</text></g></g></g><g class="annotation" data-index="3" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,300,178.82999999999998)"><g class="cursor-pointer" transform="translate(275,168)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="50" height="21"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="25.599609375" y="16">$-120K</text></g></g></g><g class="annotation" data-index="4" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,362.86,288.7)"><g class="cursor-pointer" transform="translate(337,278)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="50" height="21"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="25.599609375" y="16">$-200K</text></g></g></g><g class="annotation" data-index="5" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,425.71,288.7)"><g class="cursor-pointer" transform="translate(400,278)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="50" height="21"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="25.599609375" y="16">$-320K</text></g></g></g><g class="annotation" data-index="6" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,488.57,323.39)"><g class="cursor-pointer" transform="translate(465,312)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="46" height="21"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="23.25" y="16">$370K</text></g></g></g></g></svg>

          // Current server response is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="600" style="" viewBox="0 0 600 600"><rect x="0" y="0" width="600" height="600" style="fill: rgb(245, 246, 249); fill-opacity: 1;"/><defs id="defs-665dcc"><g class="clips"><clipPath id="clip665dccxyplot" class="plotclip"><rect width="440" height="420"/></clipPath><clipPath class="axesclip" id="clip665dccx"><rect x="80" y="0" width="440" height="600"/></clipPath><clipPath class="axesclip" id="clip665dccy"><rect x="0" y="100" width="600" height="420"/></clipPath><clipPath class="axesclip" id="clip665dccxy"><rect x="80" y="100" width="440" height="420"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,462.17)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,404.35)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,346.52)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,288.7)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,230.87)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,173.04000000000002)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,115.22)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,520)" d="M80,0h440" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip665dccxyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M0,0Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M69.14,420V171.35H119.43V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M0,0Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M194.86,420V90.39H245.14V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M257.71,420V206.04H308V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M320.57,420V206.04H370.86V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M0,0Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M6.29,420V171.35H56.57V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M69.14,171.35V21H119.43V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M132,420V21H182.29V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M194.86,90.39V90.39H245.14V90.39Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M257.71,206.04V206.04H308V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M320.57,206.04V206.04H370.86V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M383.43,420V420H433.71V420Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M6.29,171.35V171.35H56.57V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M69.14,21V21H119.43V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M132,21V21H182.29V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M194.86,90.39V21H245.14V90.39Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M257.71,206.04V90.39H308V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M320.57,206.04V21H370.86V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M383.43,420V420H433.71V420Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M6.29,171.35V171.35H56.57V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M69.14,21V21H119.43V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M132,21V21H182.29V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M194.86,21V21H245.14V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M257.71,90.39V90.39H308V90.39Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M320.57,21V21H370.86V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M383.43,420V206.04H433.71V420Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(111.43,0)"><tspan class="line" dy="0em" x="0" y="533">Product</tspan><tspan class="line" dy="1.3em" x="0" y="533">Revenue</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(174.29000000000002,0)"><tspan class="line" dy="0em" x="0" y="533">Services</tspan><tspan class="line" dy="1.3em" x="0" y="533">Revenue</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(237.14,0)"><tspan class="line" dy="0em" x="0" y="533">Total</tspan><tspan class="line" dy="1.3em" x="0" y="533">Revenue</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(300,0)"><tspan class="line" dy="0em" x="0" y="533">Fixed</tspan><tspan class="line" dy="1.3em" x="0" y="533">Costs</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(362.86,0)"><tspan class="line" dy="0em" x="0" y="533">Variable</tspan><tspan class="line" dy="1.3em" x="0" y="533">Costs</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(425.71,0)"><tspan class="line" dy="0em" x="0" y="533">Total</tspan><tspan class="line" dy="1.3em" x="0" y="533">Costs</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(488.57,0)">Total</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,520)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,462.17)">100</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,404.35)">200</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,346.52)">300</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,288.7)">400</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,230.87)">500</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,173.04000000000002)">600</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,115.22)">700</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-665dcc"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="300" y="50" text-anchor="middle" dy="0em">Annual Profit 2015</text></g><g class="g-xtitle"/><g class="g-ytitle"/><g class="annotation" data-index="0" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,111.43,288.7)"><g class="cursor-pointer" transform="translate(109,287)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$430K</text></g></g></g><g class="annotation" data-index="1" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,174.29000000000002,138.35)"><g class="cursor-pointer" transform="translate(172,136)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$260K</text></g></g></g><g class="annotation" data-index="2" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,237.14,138.35)"><g class="cursor-pointer" transform="translate(235,136)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$690K</text></g></g></g><g class="annotation" data-index="3" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,300,178.82999999999998)"><g class="cursor-pointer" transform="translate(298,177)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$-120K</text></g></g></g><g class="annotation" data-index="4" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,362.86,288.7)"><g class="cursor-pointer" transform="translate(361,287)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$-200K</text></g></g></g><g class="annotation" data-index="5" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,425.71,288.7)"><g class="cursor-pointer" transform="translate(424,287)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$-320K</text></g></g></g><g class="annotation" data-index="6" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,488.57,323.39)"><g class="cursor-pointer" transform="translate(487,321)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$370K</text></g></g></g></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="600" style="" viewBox="0 0 600 600"><rect x="0" y="0" width="600" height="600" style="fill: rgb(245, 246, 249); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('xyplot" class="plotclip"><rect width="440" height="420"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('x"><rect x="80" y="0" width="440" height="600"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('y"><rect x="0" y="100" width="600" height="420"/></clipPath><clipPath class="axesclip" id="clip') > 0);
          assert.ok(body.indexOf('xy"><rect x="80" y="100" width="440" height="420"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"><g class="subplot xy"><g class="layer-subplot"><g class="shapelayer"/><g class="imagelayer"/></g><g class="minor-gridlayer"><g class="x"/><g class="y"/></g><g class="gridlayer"><g class="x"/><g class="y"><path class="ygrid crisp" transform="translate(0,462.17)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,404.35)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,346.52)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,288.7)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,230.87)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,173.04000000000002)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid crisp" transform="translate(0,115.22)" d="M80,0h440" style="stroke: rgb(229, 230, 233); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="zerolinelayer"><path class="yzl zl crisp" transform="translate(0,520)" d="M80,0h440" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="layer-between"><g class="shapelayer"/><g class="imagelayer"/></g><path class="xlines-below"/><path class="ylines-below"/><g class="overlines-below"/><g class="xaxislayer-below"/><g class="yaxislayer-below"/><g class="overaxes-below"/><g class="overplot"><g class="xy" transform="translate(80,100)" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('xyplot)"><g class="barlayer mlayer"><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M0,0Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M69.14,420V171.35H119.43V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M0,0Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M194.86,420V90.39H245.14V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M257.71,420V206.04H308V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M320.57,420V206.04H370.86V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 0px; fill: rgb(1, 1, 1); fill-opacity: 0;" d="M0,0Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M6.29,420V171.35H56.57V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M69.14,171.35V21H119.43V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M132,420V21H182.29V420Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M194.86,90.39V90.39H245.14V90.39Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M257.71,206.04V206.04H308V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M320.57,206.04V206.04H370.86V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(55, 128, 191); fill-opacity: 0.7; stroke: rgb(55, 128, 191); stroke-opacity: 1;" d="M383.43,420V420H433.71V420Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M6.29,171.35V171.35H56.57V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M69.14,21V21H119.43V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M132,21V21H182.29V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M194.86,90.39V21H245.14V90.39Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M257.71,206.04V90.39H308V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M320.57,206.04V21H370.86V206.04Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(219, 64, 82); fill-opacity: 0.7; stroke: rgb(219, 64, 82); stroke-opacity: 1;" d="M383.43,420V420H433.71V420Z"/></g></g></g><g class="trace bars" style="opacity: 1;" shape-rendering="crispEdges"><g class="points"><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M6.29,171.35V171.35H56.57V171.35Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M69.14,21V21H119.43V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M132,21V21H182.29V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M194.86,21V21H245.14V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M257.71,90.39V90.39H308V90.39Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M320.57,21V21H370.86V21Z"/></g><g class="point"><path style="vector-effect: none; opacity: 1; stroke-width: 2px; fill: rgb(50, 171, 96); fill-opacity: 0.7; stroke: rgb(50, 171, 96); stroke-opacity: 1;" d="M383.43,420V206.04H433.71V420Z"/></g></g></g></g></g></g><path class="xlines-above crisp" style="fill: none;" d="M0,0"/><path class="ylines-above crisp" style="fill: none;" d="M0,0"/><g class="overlines-above"/><g class="xaxislayer-above"><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(111.43,0)"><tspan class="line" dy="0em" x="0" y="533">Product</tspan><tspan class="line" dy="1.3em" x="0" y="533">Revenue</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(174.29000000000002,0)"><tspan class="line" dy="0em" x="0" y="533">Services</tspan><tspan class="line" dy="1.3em" x="0" y="533">Revenue</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(237.14,0)"><tspan class="line" dy="0em" x="0" y="533">Total</tspan><tspan class="line" dy="1.3em" x="0" y="533">Revenue</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(300,0)"><tspan class="line" dy="0em" x="0" y="533">Fixed</tspan><tspan class="line" dy="1.3em" x="0" y="533">Costs</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(362.86,0)"><tspan class="line" dy="0em" x="0" y="533">Variable</tspan><tspan class="line" dy="1.3em" x="0" y="533">Costs</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(425.71,0)"><tspan class="line" dy="0em" x="0" y="533">Total</tspan><tspan class="line" dy="1.3em" x="0" y="533">Costs</tspan></text></g><g class="xtick"><text text-anchor="middle" x="0" y="533" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(488.57,0)">Total</text></g></g><g class="yaxislayer-above"><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,520)">0</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,462.17)">100</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,404.35)">200</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,346.52)">300</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,288.7)">400</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,230.87)">500</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,173.04000000000002)">600</text></g><g class="ytick"><text text-anchor="end" x="79" y="4.199999999999999" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,115.22)">700</text></g></g><g class="overaxes-above"/></g></g><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"/><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"><text class="gtitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 17px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="300" y="50" text-anchor="middle" dy="0em">Annual Profit 2015</text></g><g class="g-xtitle"/><g class="g-ytitle"/><g class="annotation" data-index="0" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,111.43,288.7)"><g class="cursor-pointer" transform="translate(109,287)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$430K</text></g></g></g><g class="annotation" data-index="1" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,174.29000000000002,138.35)"><g class="cursor-pointer" transform="translate(172,136)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$260K</text></g></g></g><g class="annotation" data-index="2" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,237.14,138.35)"><g class="cursor-pointer" transform="translate(235,136)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$690K</text></g></g></g><g class="annotation" data-index="3" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,300,178.82999999999998)"><g class="cursor-pointer" transform="translate(298,177)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$-120K</text></g></g></g><g class="annotation" data-index="4" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,362.86,288.7)"><g class="cursor-pointer" transform="translate(361,287)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$-200K</text></g></g></g><g class="annotation" data-index="5" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,425.71,288.7)"><g class="cursor-pointer" transform="translate(424,287)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$-320K</text></g></g></g><g class="annotation" data-index="6" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,488.57,323.39)"><g class="cursor-pointer" transform="translate(487,321)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: Arial; font-size: 14px; fill: rgb(245, 246, 249); fill-opacity: 1; white-space: pre;" text-anchor="middle" x="2" y="2">$370K</text></g></g></g></g></svg>') > 0);
        });
      });
    });

    // TODO: Bar Chart with Relative Barmode - https://plotly.com/javascript/bar-charts/#bar-chart-with-relative-barmode

/*
    it('request with different data', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      const payload = '{ "x": ["2013-10-04 22:23:00", "2013-11-04 22:23:00", "2013-12-04 22:23:00"], "y": [1, 3, 6], "type": "scatter" }';
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based output would be something like
          // <svg ...

          // Current server response is something like
          // <svg ...

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('') >= 0);
          assert.ok(body.indexOf('') > 0);
          assert.ok(body.indexOf('') > 0);
        });
      });
    });
    */
  });
});
