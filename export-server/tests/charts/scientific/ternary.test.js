/*
    Plotly.js offline image export server with Node.js test suite
    Copyright (C) 2024, 2025  Dirk Stolle

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/

const assert = require('node:assert');
const http = require('node:http');
const { describe, it } = require('node:test');

describe('scientific charts, part 3', () => {
  describe('ternary plots', () => {
    it('Basic Ternary Plot with Markers', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/ternary-plots/#basic-ternary-plot-with-markers example.
      const payload = `{
                         "data": [
                           {
                             "type": "scatterternary",
                             "mode": "markers",
                             "a": [ 75, 70, 75, 5, 10, 10, 20, 10, 15, 10, 20 ],
                             "b": [ 25, 10, 20, 60, 80, 90, 70, 20, 5, 10, 10 ],
                             "c": [ 0, 20, 5, 35, 10, 0, 10, 70, 80, 80, 70 ],
                             "text": [
                               "point 1", "point 2", "point 3", "point 4",
                               "point 5", "point 6", "point 7", "point 8",
                               "point 9", "point 10", "point 11"
                             ],
                             "marker": {
                               "symbol": 100,
                               "color": "#DB7365",
                               "size": 14,
                               "line": {
                                 "width": 2
                               }
                             }
                           }
                         ],
                         "layout": {
                           "ternary": {
                             "sum": 100,
                             "aaxis": {
                               "title": {
                                 "text": "Journalist",
                                 "font": {
                                   "size": 20
                                 }
                               },
                               "tickangle": 0,
                               "tickfont": {
                                 "size": 15
                               },
                               "tickcolor": "rgba(0,0,0,0)",
                               "ticklen": 5,
                               "showline": true,
                               "showgrid": true
                             },
                             "baxis": {
                               "title": {
                                 "text": "<br>Developer",
                                 "font": {
                                   "size": 20
                                 }
                               },
                               "tickangle": 45,
                               "tickfont": {
                                 "size": 15
                               },
                               "tickcolor": "rgba(0,0,0,0)",
                               "ticklen": 5,
                               "showline": true,
                               "showgrid": true
                             },
                             "caxis": {
                               "title": {
                                 "text": "<br>Designer",
                                 "font": {
                                   "size": 20
                                 }
                               },
                               "tickangle": -45,
                               "tickfont": {
                                 "size": 15
                               },
                               "tickcolor": "rgba(0,0,0,0)",
                               "ticklen": 5,
                               "showline": true,
                               "showgrid": true
                             },
                             "bgcolor": "#fff1e0"
                           },
                           "annotations": [
                             {
                               "showarrow": false,
                               "text": "Replica of Tom Pearson's <a href=\\"http://bl.ocks.org/tomgp/7674234\\">block</a>",
                               "x": 1,
                               "y": 1.3,
                               "font": {
                                 "size": 15
                               }
                             }
                           ],
                           "paper_bgcolor": "#fff1e0"
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based answer is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 241, 224); fill-opacity: 1;"/><defs id="defs-09e36c"><g class="clips"><clipPath id="clip09e36cternary"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z"/></clipPath><clipPath id="clip-relative09e36cternary"><path d="M0,270h311.7691453623979l-155.88457268119896,-270Z"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"/><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"><g class="ternary"><g class="toplevel draglayer" style="cursor: crosshair;"/><g class="toplevel plotbg" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z" style="fill: rgb(255, 241, 224); fill-opacity: 1;"/></g><g class="toplevel backplot" clip-path="url(#clip09e36cternary)" style="cursor: crosshair;"><g class="maplayer" transform="translate(194.11542731880104,100)"/></g><g class="toplevel grids" clip-path="url(#clip09e36cternary)" style="cursor: crosshair;"><g class="grid agrid" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.6508546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.2908546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.94085463760211)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.5808546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid bgrid" transform="translate(0,370)"><path class="xgrid" transform="translate(256.46542731880106,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(318.825427318801,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(381.17542731880104,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(443.535427318801,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid cgrid" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.6508546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.2908546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.94085463760211)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.5808546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="toplevel frontplot" style="cursor: crosshair;" clip-path="url(#clip09e36cternary)"><g class="scatterlayer" transform="translate(194.11542731880104,100)"><g class="trace scatter tracea46d3d" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"/><g class="points"><path class="point" transform="translate(116.91,67.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(171.47,81)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(132.5,67.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(116.91,256.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(46.77,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(15.59,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(62.35,216)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(233.83,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(272.8,229.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(265,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(249.42,216)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/></g><g class="text"/></g></g></g><g class="toplevel aaxis" style="cursor: crosshair;" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,370.00085463760206)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,307.6508546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,245.2908546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,182.94085463760211)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,120.5808546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,58.23085463760211)"/><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370.00085463760206) rotate(-30,-8.830127018922195,0.25)">0</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.6508546376021) rotate(-30,-8.830127018922195,0.25)">20</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.2908546376021) rotate(-30,-8.830127018922195,0.25)">40</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.94085463760211) rotate(-30,-8.830127018922195,0.25)">60</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.5808546376021) rotate(-30,-8.830127018922195,0.25)">80</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,58.23085463760211) rotate(-30,-8.830127018922195,0.25)">100</text></g></g><g class="toplevel aline" style="cursor: crosshair;"><path d="M194.11542731880104,370l155.88457268119896,-270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="toplevel baxis" style="cursor: crosshair;" transform="translate(0,370)"><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(194.11542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(256.46542731880106,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(318.825427318801,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(381.17542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(443.535427318801,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(505.885427318801,0)"/><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(194.11542731880104,0) rotate(45,2.4999999999999996,16.330127018922195)">100</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(256.46542731880106,0) rotate(45,2.4999999999999996,16.330127018922195)">80</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(318.825427318801,0) rotate(45,2.4999999999999996,16.330127018922195)">60</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(381.17542731880104,0) rotate(45,2.4999999999999996,16.330127018922195)">40</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(443.535427318801,0) rotate(45,2.4999999999999996,16.330127018922195)">20</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(505.885427318801,0) rotate(45,2.4999999999999996,16.330127018922195)">0</text></g></g><g class="toplevel bline" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="toplevel caxis" style="cursor: crosshair;" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,370.00085463760206)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,307.6508546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,245.2908546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,182.94085463760211)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,120.5808546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,58.23085463760211)"/><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370.00085463760206) rotate(-15,8.830127018922195,-4.75)">100</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.6508546376021) rotate(-15,8.830127018922195,-4.75)">80</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.2908546376021) rotate(-15,8.830127018922195,-4.75)">60</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.94085463760211) rotate(-15,8.830127018922195,-4.75)">40</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.5808546376021) rotate(-15,8.830127018922195,-4.75)">20</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,58.23085463760211) rotate(-15,8.830127018922195,-4.75)">0</text></g></g><g class="toplevel cline" style="cursor: crosshair;"><path d="M350,100l155.88457268119896,270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g></g></g><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-09e36c"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"/><g class="g-atitle"><text class="atitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 20px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="77.73333333333333" text-anchor="middle">Journalist</text></g><g class="g-btitle"><text class="btitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 20px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="171.11542731880104" y="409.6" text-anchor="middle"><tspan class="line" dy="0em" x="171.11542731880104" y="409.6"></tspan><tspan class="line" dy="1.3em" x="171.11542731880104" y="409.6">Developer</tspan></text></g><g class="g-ctitle"><text class="ctitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 20px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="528.884572681199" y="409.6" text-anchor="middle"><tspan class="line" dy="0em" x="528.884572681199" y="409.6"></tspan><tspan class="line" dy="1.3em" x="528.884572681199" y="409.6">Designer</tspan></text></g><g class="annotation" data-index="0" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,512,31.499999999999993)"><g class="cursor-pointer" transform="translate(404,19)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="215" height="24"/><text class="annotation-text" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; pointer-events: all;" text-anchor="middle" x="107.9501953125" y="17.5">Replica of Tom Pearson's <a xlink:show="new" target="_blank" xlink:href="http://bl.ocks.org/tomgp/7674234" style="cursor:pointer">block</a></text></g></g></g></g></svg>

          // Current server response is visually almost the same, with the annotation at a different offset.
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 241, 224); fill-opacity: 1;"/><defs id="defs-f64da1"><g class="clips"><clipPath id="clipf64da1ternary"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z"/></clipPath><clipPath id="clip-relativef64da1ternary"><path d="M0,270h311.7691453623979l-155.88457268119896,-270Z"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"/><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"><g class="ternary"><g class="toplevel draglayer" style="cursor: crosshair;"/><g class="toplevel plotbg" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z" style="fill: rgb(255, 241, 224); fill-opacity: 1;"/></g><g class="toplevel backplot" clip-path="url(#clipf64da1ternary)" style="cursor: crosshair;"><g class="maplayer" transform="translate(194.11542731880104,100)"/></g><g class="toplevel grids" clip-path="url(#clipf64da1ternary)" style="cursor: crosshair;"><g class="grid agrid" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.6508546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.2908546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.94085463760211)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.5808546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid bgrid" transform="translate(0,370)"><path class="xgrid" transform="translate(256.46542731880106,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(318.825427318801,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(381.17542731880104,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(443.535427318801,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid cgrid" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.6508546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.2908546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.94085463760211)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.5808546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="toplevel frontplot" style="cursor: crosshair;" clip-path="url(#clipf64da1ternary)"><g class="scatterlayer" transform="translate(194.11542731880104,100)"><g class="trace scatter tracecf65f5" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"/><g class="points"><path class="point" transform="translate(116.91,67.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(171.47,81)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(132.5,67.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(116.91,256.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(46.77,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(15.59,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(62.35,216)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(233.83,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(272.8,229.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(265,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(249.42,216)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/></g><g class="text"/></g></g></g><g class="toplevel aaxis" style="cursor: crosshair;" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,370.00085463760206)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,307.6508546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,245.2908546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,182.94085463760211)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,120.5808546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,58.23085463760211)"/><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370.00085463760206) rotate(-30,-8.830127018922195,0.25)">0</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.6508546376021) rotate(-30,-8.830127018922195,0.25)">20</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.2908546376021) rotate(-30,-8.830127018922195,0.25)">40</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.94085463760211) rotate(-30,-8.830127018922195,0.25)">60</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.5808546376021) rotate(-30,-8.830127018922195,0.25)">80</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,58.23085463760211) rotate(-30,-8.830127018922195,0.25)">100</text></g></g><g class="toplevel aline" style="cursor: crosshair;"><path d="M194.11542731880104,370l155.88457268119896,-270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="toplevel baxis" style="cursor: crosshair;" transform="translate(0,370)"><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(194.11542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(256.46542731880106,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(318.825427318801,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(381.17542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(443.535427318801,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(505.885427318801,0)"/><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(194.11542731880104,0) rotate(45,2.4999999999999996,16.330127018922195)">100</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(256.46542731880106,0) rotate(45,2.4999999999999996,16.330127018922195)">80</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(318.825427318801,0) rotate(45,2.4999999999999996,16.330127018922195)">60</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(381.17542731880104,0) rotate(45,2.4999999999999996,16.330127018922195)">40</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(443.535427318801,0) rotate(45,2.4999999999999996,16.330127018922195)">20</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(505.885427318801,0) rotate(45,2.4999999999999996,16.330127018922195)">0</text></g></g><g class="toplevel bline" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="toplevel caxis" style="cursor: crosshair;" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,370.00085463760206)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,307.6508546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,245.2908546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,182.94085463760211)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,120.5808546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,58.23085463760211)"/><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370.00085463760206) rotate(-15,8.830127018922195,-4.75)">100</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.6508546376021) rotate(-15,8.830127018922195,-4.75)">80</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.2908546376021) rotate(-15,8.830127018922195,-4.75)">60</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.94085463760211) rotate(-15,8.830127018922195,-4.75)">40</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.5808546376021) rotate(-15,8.830127018922195,-4.75)">20</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,58.23085463760211) rotate(-15,8.830127018922195,-4.75)">0</text></g></g><g class="toplevel cline" style="cursor: crosshair;"><path d="M350,100l155.88457268119896,270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g></g></g><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-f64da1"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"/><g class="g-atitle"><text class="atitle" style="opacity: 1; font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 20px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="77.73333333333333" text-anchor="middle">Journalist</text></g><g class="g-btitle"><text class="btitle" style="opacity: 1; font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 20px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="171.11542731880104" y="409.6" text-anchor="middle"><tspan class="line" dy="0em" x="171.11542731880104" y="409.6"></tspan><tspan class="line" dy="1.3em" x="171.11542731880104" y="409.6">Developer</tspan></text></g><g class="g-ctitle"><text class="ctitle" style="opacity: 1; font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 20px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="528.884572681199" y="409.6" text-anchor="middle"><tspan class="line" dy="0em" x="528.884572681199" y="409.6"></tspan><tspan class="line" dy="1.3em" x="528.884572681199" y="409.6">Designer</tspan></text></g><g class="annotation" data-index="0" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,618,20.999999999999986)"><g class="cursor-pointer" transform="translate(616,19)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; pointer-events: all;" text-anchor="middle" x="2" y="2">Replica of Tom Pearson's <a xlink:show="new" target="_blank" xlink:href="http://bl.ocks.org/tomgp/7674234" style="cursor:pointer">block</a></text></g></g></g></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 241, 224); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('ternary"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z"/></clipPath><clipPath id="clip-relative') > 0);
          assert.ok(body.indexOf('ternary"><path d="M0,270h311.7691453623979l-155.88457268119896,-270Z"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"/><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"><g class="ternary"><g class="toplevel draglayer" style="cursor: crosshair;"/><g class="toplevel plotbg" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z" style="fill: rgb(255, 241, 224); fill-opacity: 1;"/></g><g class="toplevel backplot" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('ternary)" style="cursor: crosshair;"><g class="maplayer" transform="translate(194.11542731880104,100)"/></g><g class="toplevel grids" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('ternary)" style="cursor: crosshair;"><g class="grid agrid" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.6508546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.2908546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.94085463760211)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.5808546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid bgrid" transform="translate(0,370)"><path class="xgrid" transform="translate(256.46542731880106,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(318.825427318801,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(381.17542731880104,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(443.535427318801,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid cgrid" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.6508546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.2908546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.94085463760211)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.5808546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 172, 162); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="toplevel frontplot" style="cursor: crosshair;" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('ternary)"><g class="scatterlayer" transform="translate(194.11542731880104,100)"><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"/><g class="points"><path class="point" transform="translate(116.91,67.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(171.47,81)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(132.5,67.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(116.91,256.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(46.77,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(15.59,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(62.35,216)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(233.83,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(272.8,229.5)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(265,243)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/><path class="point" transform="translate(249.42,216)" style="opacity: 1; stroke: rgb(219, 115, 101); stroke-opacity: 1; stroke-width: 2px; fill: none;" d="M7,0A7,7 0 1,1 0,-7A7,7 0 0,1 7,0Z"/></g><g class="text"/></g></g></g><g class="toplevel aaxis" style="cursor: crosshair;" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,370.00085463760206)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,307.6508546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,245.2908546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,182.94085463760211)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,120.5808546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M-0.5,0l-4.330127018922194,2.4999999999999996" transform="translate(0,58.23085463760211)"/><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370.00085463760206) rotate(-30,-8.830127018922195,0.25)">0</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.6508546376021) rotate(-30,-8.830127018922195,0.25)">20</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.2908546376021) rotate(-30,-8.830127018922195,0.25)">40</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.94085463760211) rotate(-30,-8.830127018922195,0.25)">60</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.5808546376021) rotate(-30,-8.830127018922195,0.25)">80</text></g><g class="ytick"><text text-anchor="end" x="-8.830127018922195" y="7.75" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,58.23085463760211) rotate(-30,-8.830127018922195,0.25)">100</text></g></g><g class="toplevel aline" style="cursor: crosshair;"><path d="M194.11542731880104,370l155.88457268119896,-270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="toplevel baxis" style="cursor: crosshair;" transform="translate(0,370)"><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(194.11542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(256.46542731880106,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(318.825427318801,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(381.17542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(443.535427318801,0)"/><path class="xtick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0,0.5l2.4999999999999996,4.330127018922194" transform="translate(505.885427318801,0)"/><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(194.11542731880104,0) rotate(45,2.4999999999999996,16.330127018922195)">100</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(256.46542731880106,0) rotate(45,2.4999999999999996,16.330127018922195)">80</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(318.825427318801,0) rotate(45,2.4999999999999996,16.330127018922195)">60</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(381.17542731880104,0) rotate(45,2.4999999999999996,16.330127018922195)">40</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(443.535427318801,0) rotate(45,2.4999999999999996,16.330127018922195)">20</text></g><g class="xtick"><text text-anchor="start" x="2.4999999999999996" y="23.830127018922195" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(505.885427318801,0) rotate(45,2.4999999999999996,16.330127018922195)">0</text></g></g><g class="toplevel bline" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="toplevel caxis" style="cursor: crosshair;" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,370.00085463760206)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,307.6508546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,245.2908546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,182.94085463760211)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,120.5808546376021)"/><path class="ytick ticks" style="stroke: rgb(0, 0, 0); stroke-opacity: 0; stroke-width: 1px;" d="M0.5,0l4.330127018922194,-2.4999999999999996" transform="translate(0,58.23085463760211)"/><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,370.00085463760206) rotate(-15,8.830127018922195,-4.75)">100</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.6508546376021) rotate(-15,8.830127018922195,-4.75)">80</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.2908546376021) rotate(-15,8.830127018922195,-4.75)">60</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.94085463760211) rotate(-15,8.830127018922195,-4.75)">40</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.5808546376021) rotate(-15,8.830127018922195,-4.75)">20</text></g><g class="ytick"><text text-anchor="start" x="8.830127018922195" y="2.7500000000000004" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,58.23085463760211) rotate(-15,8.830127018922195,-4.75)">0</text></g></g><g class="toplevel cline" style="cursor: crosshair;"><path d="M350,100l155.88457268119896,270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;"/></g></g></g><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"/><g class="g-atitle"><text class="atitle" style="opacity: 1; font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 20px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="77.73333333333333" text-anchor="middle">Journalist</text></g><g class="g-btitle"><text class="btitle" style="opacity: 1; font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 20px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="171.11542731880104" y="409.6" text-anchor="middle"><tspan class="line" dy="0em" x="171.11542731880104" y="409.6"></tspan><tspan class="line" dy="1.3em" x="171.11542731880104" y="409.6">Developer</tspan></text></g><g class="g-ctitle"><text class="ctitle" style="opacity: 1; font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 20px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="528.884572681199" y="409.6" text-anchor="middle"><tspan class="line" dy="0em" x="528.884572681199" y="409.6"></tspan><tspan class="line" dy="1.3em" x="528.884572681199" y="409.6">Designer</tspan></text></g><g class="annotation" data-index="0" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,618,20.999999999999986)"><g class="cursor-pointer" transform="translate(616,19)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 15px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; pointer-events: all;" text-anchor="middle" x="2" y="2">Replica of Tom Pearson\'s <a xlink:show="new" target="_blank" xlink:href="http://bl.ocks.org/tomgp/7674234" style="cursor:pointer">block</a></text></g></g></g></g></svg>') > 0);
        });
      });
    });

    it('Soil Types Ternary Plot', () => {
      const options = {
        port: 3000,
        host: 'localhost',
        method: 'POST'
      };

      const req = http.request(options);
      // Data taken from https://plotly.com/javascript/ternary-plots/#soil-types-ternary-plot example.
      const payload = `{
                         "data": [
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "sand",
                             "a": [ 0, 10, 0 ],
                             "b": [ 100, 90, 90 ],
                             "c": [ 0, 0, 10 ],
                             "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "loamy sand",
                             "a": [ 0, 10, 15, 0 ],
                             "b": [ 90, 90, 85, 70 ],
                             "c": [ 10, 0, 0, 30 ],
                             "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "sandy loam",
                             "a": [ 0, 15, 20, 20, 5, 5, 0 ],
                             "b": [ 70, 85, 80, 53, 53, 45, 50 ],
                             "c": [ 30, 0, 0, 32, 42, 50, 50 ],
                             "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "sandy clay loam",
                             "a": [ 20, 35, 35, 28, 20 ],
                             "b": [ 80, 65, 45, 45, 53 ],
                             "c": [ 0, 0, 20, 27, 32 ],
                             "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "sandy clay",
                             "a": [ 35, 35, 55 ],
                             "b": [ 65, 45, 45 ],
                             "c": [ 0, 20, 0 ],
                             "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "clay",
                             "a": [ 55, 100, 60, 40, 40 ],
                             "b": [ 45, 0, 0, 20, 45 ],
                             "c": [ 0, 0, 40, 40, 15 ],
                             "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                              "mode": "lines",
                              "name": "clay loam",
                              "a": [ 40, 40, 28, 28 ],
                              "b": [ 45, 20, 20, 45 ],
                              "c": [ 15, 40, 52, 27 ],
                              "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "silty clay",
                             "a": [ 60, 40, 40 ],
                             "b": [ 0, 0, 20 ],
                             "c": [ 40, 60, 40 ],
                             "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "silty clay loam",
                             "a": [ 28, 28, 40, 40 ],
                             "b": [ 0, 20, 20, 0 ],
                             "c": [ 72, 52, 40, 60 ],
                             "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "silty loam",
                             "a": [ 0, 28, 28, 12, 12, 0 ],
                             "b": [ 50, 22, 0, 0, 8, 20 ],
                             "c": [ 50, 50, 72, 88, 80, 80 ],
                             "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "silt",
                             "a": [ 0, 0, 12, 12 ],
                             "b": [ 0, 20, 8, 0 ],
                             "c": [ 100, 80, 80, 88 ],
                             "line": {
                               "color": "#c00"
                             }
                           },
                           {
                             "type": "scatterternary",
                             "mode": "lines",
                             "name": "loam",
                             "a": [ 28, 28, 5, 5, 20 ],
                             "b": [ 45, 22, 45, 53, 53 ],
                             "c": [ 27, 50, 50, 42, 32 ],
                             "line": {
                               "color": "#c00"
                             }
                           }
                         ],
                         "layout": {
                           "ternary": {
                             "sum": 100,
                             "aaxis": {
                               "title": {
                                 "text": "Clay"
                               },
                               "ticksuffix": "%",
                               "min": 0.01,
                               "linewidth": 2,
                               "ticks": "outside",
                               "ticklen": 8,
                               "showgrid": true
                             },
                             "baxis": {
                               "title": {
                                 "text": "Sand"
                               },
                               "ticksuffix": "%",
                               "min": 0.01,
                               "linewidth": 2,
                               "ticks": "outside",
                               "ticklen": 8,
                               "showgrid": true
                             },
                             "caxis": {
                               "title": {
                                 "text": "Silt"
                               },
                               "ticksuffix": "%",
                               "min": 0.01,
                               "linewidth": 2,
                               "ticks": "outside",
                               "ticklen": 8,
                               "showgrid": true
                             }
                           },
                           "showlegend": false,
                           "width": 700,
                           "annotations": [
                             {
                               "showarrow": false,
                                "text": "Replica of Daven Quinn's <a href=\\"http://bl.ocks.org/davenquinn/988167471993bc2ece29\\">block</a>",
                                "x": 0.15,
                                "y": 1.1
                             }
                           ]
                         }
                       }`;
      req.write(payload);
      req.end();

      req.on('response', (response) => {
        assert.strictEqual(200, response.statusCode);
        let body = '';
        response.on('data', (chunk) => {
          body += chunk;
        });
        response.on('end', () => {
          assert.ok(body.startsWith('<svg'));
          assert.ok(body.endsWith('</svg>'));

          // Browser-based answer is something like
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-f2796c"><g class="clips"><clipPath id="clipf2796cternary"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z"/></clipPath><clipPath id="clip-relativef2796cternary"><path d="M0,270h311.7691453623979l-155.88457268119896,-270Z"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"/><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"><g class="ternary"><g class="toplevel draglayer" style="cursor: crosshair;"/><g class="toplevel plotbg" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/></g><g class="toplevel backplot" clip-path="url(#clipf2796cternary)" style="cursor: crosshair;"><g class="maplayer" transform="translate(194.11542731880104,100)"/></g><g class="toplevel grids" clip-path="url(#clipf2796cternary)" style="cursor: crosshair;"><g class="grid agrid" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.66085463760214)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.2908546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.9108546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.54085463760211)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid bgrid" transform="translate(0,370)"><path class="xgrid" transform="translate(256.42542731880104,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(318.79542731880105,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(381.17542731880104,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(443.54542731880105,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid cgrid" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.6908546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.3208546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.94085463760211)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.57085463760211)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="toplevel frontplot" style="cursor: crosshair;" clip-path="url(#clipf2796cternary)"><g class="scatterlayer" transform="translate(194.11542731880104,100)"><g class="trace scatter tracea81eaf" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M-0.05,270.03L15.55,243.02L31.14,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace6ad599" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M31.14,270.03L15.55,243.02L23.34,229.51L93.51,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter tracec7d2ad" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M93.51,270.03L23.34,229.51L31.14,216.01L124.7,218.58L138.73,256.52L163.68,256.52L155.88,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace7ad44e" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M31.14,216.01L54.53,175.5L116.9,175.5L127.82,194.4L124.7,218.58"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace8afa05" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M54.53,175.5L116.9,175.5L85.72,121.48"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace0112c9" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M85.72,121.48L155.88,-0.05L218.26,107.98L187.07,161.99L109.11,161.99"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace1bda14" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M109.11,161.99L187.07,161.99L205.78,194.4L127.82,194.4"/></g><g class="points"/><g class="text"/></g><g class="trace scatter traced540d7" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M218.26,107.98L249.44,161.99L187.07,161.99"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace79c1dc" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M268.16,194.4L205.78,194.4L187.07,161.99L249.44,161.99"/></g><g class="points"/><g class="text"/></g><g class="trace scatter tracee83137" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M155.88,270.03L199.55,194.4L268.16,194.4L293.1,237.62L268.16,237.62L249.44,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter tracec91d8b" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M311.82,270.03L249.44,270.03L268.16,237.62L293.1,237.62"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace9e74c4" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M127.82,194.4L199.55,194.4L163.68,256.52L138.73,256.52L124.7,218.58"/></g><g class="points"/><g class="text"/></g></g></g><g class="toplevel aaxis" style="cursor: crosshair;" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,307.66085463760214)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,245.2908546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,182.9108546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,120.54085463760211)"/><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.66085463760214) rotate(-30,-11.32820323027551,2.1999999999999993)">20%</text></g><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.2908546376021) rotate(-30,-11.32820323027551,2.1999999999999993)">40%</text></g><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.9108546376021) rotate(-30,-11.32820323027551,2.1999999999999993)">60%</text></g><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.54085463760211) rotate(-30,-11.32820323027551,2.1999999999999993)">80%</text></g></g><g class="toplevel aline" style="cursor: crosshair;"><path d="M194.11542731880104,370l155.88457268119896,-270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 2px;"/></g><g class="toplevel baxis" style="cursor: crosshair;" transform="translate(0,370)"><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(256.42542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(318.79542731880105,0)"/><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(381.17542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(443.54542731880105,0)"/><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(256.42542731880104,0)">80%</text></g><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(318.79542731880105,0)">60%</text></g><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(381.17542731880104,0)">40%</text></g><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(443.54542731880105,0)">20%</text></g></g><g class="toplevel bline" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 2px;"/></g><g class="toplevel caxis" style="cursor: crosshair;" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,307.6908546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,245.3208546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,182.94085463760211)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,120.57085463760211)"/><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.6908546376021) rotate(30,11.32820323027551,-5.800000000000001)">80%</text></g><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.3208546376021) rotate(30,11.32820323027551,-5.800000000000001)">60%</text></g><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.94085463760211) rotate(30,11.32820323027551,-5.800000000000001)">40%</text></g><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.57085463760211) rotate(30,11.32820323027551,-5.800000000000001)">20%</text></g></g><g class="toplevel cline" style="cursor: crosshair;"><path d="M350,100l155.88457268119896,270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 2px;"/></g></g></g><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-f2796c"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"/><g class="g-atitle"><text class="atitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="79.37333333333333" text-anchor="middle">Clay</text></g><g class="g-btitle"><text class="btitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="171.11542731880104" y="404.62" text-anchor="middle">Sand</text></g><g class="g-ctitle"><text class="ctitle" style="opacity: 1; font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="528.884572681199" y="404.62" text-anchor="middle">Silt</text></g><g class="annotation" data-index="0" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,247.5,83.49999999999997)"><g class="cursor-pointer" transform="translate(161,73)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="172" height="20"/><text class="annotation-text" style="font-family: TOBESTRIPPEDOpen SansTOBESTRIPPED, verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; pointer-events: all;" text-anchor="middle" x="86.6669921875" y="14.5">Replica of Daven Quinn's <a xlink:show="new" target="_blank" xlink:href="http://bl.ocks.org/davenquinn/988167471993bc2ece29" style="cursor:pointer">block</a></text></g></g></g></g></svg>

          // Current server response is visually almost the same, except for the annotation offset.
          // <svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-837800"><g class="clips"><clipPath id="clip837800ternary"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z"/></clipPath><clipPath id="clip-relative837800ternary"><path d="M0,270h311.7691453623979l-155.88457268119896,-270Z"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"/><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"><g class="ternary"><g class="toplevel draglayer" style="cursor: crosshair;"/><g class="toplevel plotbg" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/></g><g class="toplevel backplot" clip-path="url(#clip837800ternary)" style="cursor: crosshair;"><g class="maplayer" transform="translate(194.11542731880104,100)"/></g><g class="toplevel grids" clip-path="url(#clip837800ternary)" style="cursor: crosshair;"><g class="grid agrid" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.66085463760214)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.2908546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.9108546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.54085463760211)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid bgrid" transform="translate(0,370)"><path class="xgrid" transform="translate(256.42542731880104,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(318.79542731880105,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(381.17542731880104,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(443.54542731880105,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid cgrid" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.6908546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.3208546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.94085463760211)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.57085463760211)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="toplevel frontplot" style="cursor: crosshair;" clip-path="url(#clip837800ternary)"><g class="scatterlayer" transform="translate(194.11542731880104,100)"><g class="trace scatter trace9219d0" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M-0.05,270.03L15.55,243.02L31.14,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace5f7fb0" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M31.14,270.03L15.55,243.02L23.34,229.51L93.51,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace645f4d" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M93.51,270.03L23.34,229.51L31.14,216.01L124.7,218.58L138.73,256.52L163.68,256.52L155.88,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace926baf" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M31.14,216.01L54.53,175.5L116.9,175.5L127.82,194.4L124.7,218.58"/></g><g class="points"/><g class="text"/></g><g class="trace scatter tracec9f918" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M54.53,175.5L116.9,175.5L85.72,121.48"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace109324" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M85.72,121.48L155.88,-0.05L218.26,107.98L187.07,161.99L109.11,161.99"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace74570e" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M109.11,161.99L187.07,161.99L205.78,194.4L127.82,194.4"/></g><g class="points"/><g class="text"/></g><g class="trace scatter tracee4337d" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M218.26,107.98L249.44,161.99L187.07,161.99"/></g><g class="points"/><g class="text"/></g><g class="trace scatter tracef70731" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M268.16,194.4L205.78,194.4L187.07,161.99L249.44,161.99"/></g><g class="points"/><g class="text"/></g><g class="trace scatter traced67deb" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M155.88,270.03L199.55,194.4L268.16,194.4L293.1,237.62L268.16,237.62L249.44,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace547b5e" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M311.82,270.03L249.44,270.03L268.16,237.62L293.1,237.62"/></g><g class="points"/><g class="text"/></g><g class="trace scatter traced513f5" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M127.82,194.4L199.55,194.4L163.68,256.52L138.73,256.52L124.7,218.58"/></g><g class="points"/><g class="text"/></g></g></g><g class="toplevel aaxis" style="cursor: crosshair;" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,307.66085463760214)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,245.2908546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,182.9108546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,120.54085463760211)"/><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.66085463760214) rotate(-30,-11.32820323027551,2.1999999999999993)">20%</text></g><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.2908546376021) rotate(-30,-11.32820323027551,2.1999999999999993)">40%</text></g><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.9108546376021) rotate(-30,-11.32820323027551,2.1999999999999993)">60%</text></g><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.54085463760211) rotate(-30,-11.32820323027551,2.1999999999999993)">80%</text></g></g><g class="toplevel aline" style="cursor: crosshair;"><path d="M194.11542731880104,370l155.88457268119896,-270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 2px;"/></g><g class="toplevel baxis" style="cursor: crosshair;" transform="translate(0,370)"><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(256.42542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(318.79542731880105,0)"/><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(381.17542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(443.54542731880105,0)"/><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(256.42542731880104,0)">80%</text></g><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(318.79542731880105,0)">60%</text></g><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(381.17542731880104,0)">40%</text></g><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(443.54542731880105,0)">20%</text></g></g><g class="toplevel bline" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 2px;"/></g><g class="toplevel caxis" style="cursor: crosshair;" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,307.6908546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,245.3208546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,182.94085463760211)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,120.57085463760211)"/><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.6908546376021) rotate(30,11.32820323027551,-5.800000000000001)">80%</text></g><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.3208546376021) rotate(30,11.32820323027551,-5.800000000000001)">60%</text></g><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.94085463760211) rotate(30,11.32820323027551,-5.800000000000001)">40%</text></g><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.57085463760211) rotate(30,11.32820323027551,-5.800000000000001)">20%</text></g></g><g class="toplevel cline" style="cursor: crosshair;"><path d="M350,100l155.88457268119896,270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 2px;"/></g></g></g><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-837800"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"/><g class="g-atitle"><text class="atitle" style="opacity: 1; font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="79.37333333333333" text-anchor="middle">Clay</text></g><g class="g-btitle"><text class="btitle" style="opacity: 1; font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="171.11542731880104" y="404.62" text-anchor="middle">Sand</text></g><g class="g-ctitle"><text class="ctitle" style="opacity: 1; font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="528.884572681199" y="404.62" text-anchor="middle">Silt</text></g><g class="annotation" data-index="0" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,163,74.99999999999997)"><g class="cursor-pointer" transform="translate(161,73)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: 'Open Sans', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; pointer-events: all;" text-anchor="middle" x="2" y="2">Replica of Daven Quinn's <a xlink:show="new" target="_blank" xlink:href="http://bl.ocks.org/davenquinn/988167471993bc2ece29" style="cursor:pointer">block</a></text></g></g></g></g></svg>

          // Check partial matches, avoiding the random id bits.
          assert.ok(body.indexOf('<svg class="main-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700" height="450" style="" viewBox="0 0 700 450"><rect x="0" y="0" width="700" height="450" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/><defs id="defs-') >= 0);
          assert.ok(body.indexOf('<g class="clips"><clipPath id="clip') > 0);
          assert.ok(body.indexOf('ternary"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z"/></clipPath><clipPath id="clip-relative') > 0);
          assert.ok(body.indexOf('ternary"><path d="M0,270h311.7691453623979l-155.88457268119896,-270Z"/></clipPath></g><g class="gradients"/><g class="patterns"/></defs><g class="bglayer"/><g class="layer-below"><g class="imagelayer"/><g class="shapelayer"/></g><g class="cartesianlayer"/><g class="polarlayer"/><g class="smithlayer"/><g class="ternarylayer"><g class="ternary"><g class="toplevel draglayer" style="cursor: crosshair;"/><g class="toplevel plotbg" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979l-155.88457268119896,-270Z" style="fill: rgb(255, 255, 255); fill-opacity: 1;"/></g><g class="toplevel backplot" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('ternary)" style="cursor: crosshair;"><g class="maplayer" transform="translate(194.11542731880104,100)"/></g><g class="toplevel grids" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('ternary)" style="cursor: crosshair;"><g class="grid agrid" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.66085463760214)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.2908546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.9108546376021)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.54085463760211)" d="M0,0l270,-155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid bgrid" transform="translate(0,370)"><path class="xgrid" transform="translate(256.42542731880104,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(318.79542731880105,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(381.17542731880104,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="xgrid" transform="translate(443.54542731880105,0)" d="M0,0l-155.88457268119896,-270" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/></g><g class="grid cgrid" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ygrid" transform="translate(0,307.6908546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,245.3208546376021)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,182.94085463760211)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/><path class="ygrid" transform="translate(0,120.57085463760211)" d="M0,0l-270,155.88457268119896" style="stroke: rgb(180, 180, 180); stroke-opacity: 1; stroke-width: 1px;"/></g></g><g class="toplevel frontplot" style="cursor: crosshair;" clip-path="url(#clip') > 0);
          assert.ok(body.indexOf('ternary)"><g class="scatterlayer" transform="translate(194.11542731880104,100)"><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M-0.05,270.03L15.55,243.02L31.14,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M31.14,270.03L15.55,243.02L23.34,229.51L93.51,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M93.51,270.03L23.34,229.51L31.14,216.01L124.7,218.58L138.73,256.52L163.68,256.52L155.88,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M31.14,216.01L54.53,175.5L116.9,175.5L127.82,194.4L124.7,218.58"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M54.53,175.5L116.9,175.5L85.72,121.48"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M85.72,121.48L155.88,-0.05L218.26,107.98L187.07,161.99L109.11,161.99"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M109.11,161.99L187.07,161.99L205.78,194.4L127.82,194.4"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M218.26,107.98L249.44,161.99L187.07,161.99"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M268.16,194.4L205.78,194.4L187.07,161.99L249.44,161.99"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M155.88,270.03L199.55,194.4L268.16,194.4L293.1,237.62L268.16,237.62L249.44,270.03"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M311.82,270.03L249.44,270.03L268.16,237.62L293.1,237.62"/></g><g class="points"/><g class="text"/></g><g class="trace scatter trace') > 0);
          assert.ok(body.indexOf('" style="stroke-miterlimit: 2; opacity: 1;"><g class="fills"/><g class="errorbars"/><g class="lines"><path class="js-line" style="vector-effect: none; fill: none; stroke: rgb(204, 0, 0); stroke-opacity: 1; stroke-width: 2px; opacity: 1;" d="M127.82,194.4L199.55,194.4L163.68,256.52L138.73,256.52L124.7,218.58"/></g><g class="points"/><g class="text"/></g></g></g><g class="toplevel aaxis" style="cursor: crosshair;" transform="translate(350,100)rotate(30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,307.66085463760214)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,245.2908546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,182.9108546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M-1,0l-6.92820323027551,3.9999999999999996" transform="translate(0,120.54085463760211)"/><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.66085463760214) rotate(-30,-11.32820323027551,2.1999999999999993)">20%</text></g><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.2908546376021) rotate(-30,-11.32820323027551,2.1999999999999993)">40%</text></g><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.9108546376021) rotate(-30,-11.32820323027551,2.1999999999999993)">60%</text></g><g class="ytick"><text text-anchor="end" x="-11.32820323027551" y="8.2" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.54085463760211) rotate(-30,-11.32820323027551,2.1999999999999993)">80%</text></g></g><g class="toplevel aline" style="cursor: crosshair;"><path d="M194.11542731880104,370l155.88457268119896,-270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 2px;"/></g><g class="toplevel baxis" style="cursor: crosshair;" transform="translate(0,370)"><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(256.42542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(318.79542731880105,0)"/><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(381.17542731880104,0)"/><path class="xtick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M0,1l3.9999999999999996,6.92820323027551" transform="translate(443.54542731880105,0)"/><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(256.42542731880104,0)">80%</text></g><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(318.79542731880105,0)">60%</text></g><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(381.17542731880104,0)">40%</text></g><g class="xtick"><text text-anchor="middle" x="3.9999999999999996" y="23.32820323027551" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(443.54542731880105,0)">20%</text></g></g><g class="toplevel bline" style="cursor: crosshair;"><path d="M194.11542731880104,370h311.7691453623979" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 2px;"/></g><g class="toplevel caxis" style="cursor: crosshair;" transform="translate(350,100)rotate(-30)translate(0,-58.23085463760211)"><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,307.6908546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,245.3208546376021)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,182.94085463760211)"/><path class="ytick ticks" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 1px;" d="M1,0l6.92820323027551,-3.9999999999999996" transform="translate(0,120.57085463760211)"/><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,307.6908546376021) rotate(30,11.32820323027551,-5.800000000000001)">80%</text></g><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,245.3208546376021) rotate(30,11.32820323027551,-5.800000000000001)">60%</text></g><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,182.94085463760211) rotate(30,11.32820323027551,-5.800000000000001)">40%</text></g><g class="ytick"><text text-anchor="start" x="11.32820323027551" y="0.19999999999999973" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; opacity: 1;" transform="translate(0,120.57085463760211) rotate(30,11.32820323027551,-5.800000000000001)">20%</text></g></g><g class="toplevel cline" style="cursor: crosshair;"><path d="M350,100l155.88457268119896,270" style="stroke: rgb(68, 68, 68); stroke-opacity: 1; stroke-width: 2px;"/></g></g></g><g class="geolayer"/><g class="funnelarealayer"/><g class="pielayer"/><g class="iciclelayer"/><g class="treemaplayer"/><g class="sunburstlayer"/><g class="glimages"/><defs id="topdefs-') > 0);
          assert.ok(body.indexOf('"><g class="clips"/></defs><g class="layer-above"><g class="imagelayer"/><g class="shapelayer"/></g><g class="infolayer"><g class="g-gtitle"/><g class="g-atitle"><text class="atitle" style="opacity: 1; font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="350" y="79.37333333333333" text-anchor="middle">Clay</text></g><g class="g-btitle"><text class="btitle" style="opacity: 1; font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="171.11542731880104" y="404.62" text-anchor="middle">Sand</text></g><g class="g-ctitle"><text class="ctitle" style="opacity: 1; font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 14px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre;" x="528.884572681199" y="404.62" text-anchor="middle">Silt</text></g><g class="annotation" data-index="0" style="opacity: 1;"><g class="annotation-text-g" transform="rotate(0,163,74.99999999999997)"><g class="cursor-pointer" transform="translate(161,73)"><rect class="bg" style="stroke-width: 1px; stroke: rgb(0, 0, 0); stroke-opacity: 0; fill: rgb(0, 0, 0); fill-opacity: 0;" x="0.5" y="0.5" width="3" height="3"/><text class="annotation-text" style="font-family: \'Open Sans\', verdana, arial, sans-serif; font-size: 12px; fill: rgb(68, 68, 68); fill-opacity: 1; white-space: pre; pointer-events: all;" text-anchor="middle" x="2" y="2">Replica of Daven Quinn\'s <a xlink:show="new" target="_blank" xlink:href="http://bl.ocks.org/davenquinn/988167471993bc2ece29" style="cursor:pointer">block</a></text></g></g></g></g></svg>') > 0);
        });
      });
    });
  });
});
